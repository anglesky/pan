define("app/src/app/main",["lib/jquery-lib","lib/util","lib/artDialog/jquery-artDialog","../../common/core","../../tpl/copyright.html","../../tpl/search.html","../../tpl/search_list.html","../../tpl/upload.html","./page"],function(e){e("lib/jquery-lib"),e("lib/util"),e("lib/artDialog/jquery-artDialog"),core=e("../../common/core"),App=e("./page"),App.init()}),define("app/common/core",[],function(require,exports){loadRipple(["a","button","label",".context-menu-item","#picker"]),$("a,img").attr("draggable","false"),$(document).bind("mouseup",function(){window.focus()});var init_first=function(){window.require=require,core.update(),"undefined"!=typeof G&&(1!=G.is_root&&$(".menu_system_setting").remove(),G.is_root||1==AUTH["system_member:get"]||1==AUTH["system_group:get"]||$(".menu_system_group").remove())};return{init:init_first,filetype:{image:["jpg","jpeg","png","bmp","gif","ico"],music:["mp3","wma","wav","mid","m4a","aac","midi"],movie:["avi","flv","f4v","wmv","3gp","mp4","wmv","asf","m4v","mov","mpg"],doc:["doc","docx","docm","xls","xlsx","xlsb","xlsm","ppt","pptx","pptm"],text:["oexe","inc","inf","csv","log","asc","tsv","lnk","url","webloc","meta"],code:["abap","abc","as","ada","adb","htgroups","htpasswd","conf","htaccess","htgroups","htpasswd","asciidoc","asm","ahk","bat","cmd","c9search_results","cpp","c","cc","cxx","h","hh","hpp","cirru","cr","clj","cljs","CBL","COB","coffee","cf","cson","Cakefile","cfm","cs","css","curly","d","di","dart","diff","patch","Dockerfile","dot","dummy","dummy","e","ejs","ex","exs","elm","erl","hrl","frt","fs","ldr","ftl","gcode","feature","gitignore","glsl","frag","vert","go","groovy","haml","hbs","handlebars","tpl","mustache","hs","hx","html","htm","xhtml","erb","rhtml","ini","strings","cfg","prefs","io","jack","jade","java","js","jsm","json","jq","jsp","jsx","jl","tex","latex","ltx","bib","lean","hlean","less","liquid","lisp","ls","logic","lql","lsl","lua","lp","lucene","Makefile","makefile","GNUmakefile","makefile","OCamlMakefile","make","md","rst","markdown","mask","matlab","mel","mc","mush","mysql","nix","m","mm","ml","mli","pas","p","pl","pm","pgsql","php","phtml","ps1","praat","praatscript","psc","proc","plg","prolog","properties","proto","py","r","Rd","Rhtml","rb","ru","gemspec","rake","Guardfile","Rakefile","Gemfile","rs","sass","scad","scala","scm","rkt","scss","sh","bash","bashrc","sjs","smarty","tpl","snippets","soy","space","sql","styl","stylus","svg","tcl","tex","txt","textile","toml","twig","ts","typescript","str","vala","vbs","vb","vm","v","vh","sv","svh","vhd","vhdl","xml","rdf","rss","wsdl","xslt","atom","mathml","mml","xul","xbl","xaml","xq","yaml","yml","htm","xib","xsd","storyboard","plist","csproj","pch","pbxproj","local","xcscheme"],bindary:["pdf","bin","zip","swf","gzip","rar","arj","tar","gz","cab","tbz","tbz2","lzh","uue","bz2","ace","exe","so","dll","chm","rtf","odp","odt","pages","class","psd","ttf","fla","7z","dmg","iso","dat","ipa","lib","a","apk","so","o"]},ico:function(e){var a=["edit","search","upload","setting","appStore","error","info"],t=["folder","file","mp3","flv","pdf","doc","xls","ppt","html","swf","php","js","zip","rar","txt","jpg"];return $.inArray(e,a)>=0?G.static_path+"images/file_icon/icon_others/"+e+".png":$.inArray(e,t)>=0?G.static_path+"images/file_icon/file_16/"+e+".png":G.static_path+"images/file_icon/file_16/file.png"},contextmenu:function(e){try{rightMenu.hidden()}catch(a){}var a=e||window.event;return a?a&&$(a.target).is("textarea")||$(a.target).is("input")||$(a.target).is("p")||$(a.target).is("pre")||0!=$(a.target).parents(".can_right_menu").length||0!=$(a.target).parents(".topbar").length||0!=$(a.target).parents(".edit_body").length||0!=$(a.target).parents(".aui_state_focus").length?!0:!1:!0},pathThis:function(e){if(!e||"/"==e)return"";e=e=this.pathClear(e);var a=e.lastIndexOf("/"),t=e.substr(a+1);if(0==t.search("fileProxy")){t=urlDecode(t.substr(t.search("&path=")));var i=t.split("/");t=i[i.length-1],""==t&&(t=i[i.length-2])}return t},pathClear:function(e){return e=e.replace(/\\/g,"/"),e=rtrim(e,"/"),e=e.replace(/\/+/g,"/")},pathFather:function(e){e=this.pathClear(e);var a=e.lastIndexOf("/");return e.substr(0,a+1)},pathExt:function(e){e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/");var a=e.lastIndexOf(".");return e=e.substr(a+1),e.toLowerCase()},path2url:function(e){if("http"==e.substr(0,4))return e;if(e=e.replace(/\\/g,"/"),e=rtrim(e,"/"),e=e.replace(/\/+/g,"/"),e=e.replace(/\/\.*\//g,"/"),G.is_root&&e.substring(0,G.web_root.length)==G.web_root)return G.web_host+e.replace(G.web_root,"");var a=G.app_host+"/index.php?explorer/fileProxy&path="+urlEncode(e);return G.share_page!==void 0&&(a=G.app_host+"/index.php?share/fileProxy&user="+G.user+"&sid="+G.sid+"&path="+urlEncode(e)),a},path_can_read:function(e){if("object"!=typeof G.json_data)return!0;var a;a=G.json_data.filelist;for(var t=0;a.length>t;t++)if(a[t].path==e)return void 0==a[t].is_readable||1==a[t].is_readable?!0:!1;a=G.json_data.folderlist;for(var t=0;a.length>t;t++)if(a[t].path==e)return void 0==a[t].is_readable||1==a[t].is_readable?!0:!1;return!0},authCheck:function(e,a){return G.is_root?!0:AUTH.hasOwnProperty(e)?AUTH[e]?!0:(void 0==a&&(a=LNG.no_permission),core.tips.tips(a,!1),!1):!0},ajaxError:function(e){core.tips.close(LNG.system_error,!1);var a=e.responseText,t='<div class="ajaxError">'+a+"</div>",i=$.dialog.list.ajaxErrorDialog;return"<!--user login-->"==a.substr(0,17)?(FrameCall.goRefresh(),void 0):(i?i.content(t):$.dialog({id:"ajaxErrorDialog",padding:0,width:"60%",height:"50%",fixed:!0,resize:!0,ico:core.ico("error"),title:"ajax error",content:t}),void 0)},file_get:function(e,a){var t="./index.php?editor/fileGet&filename="+urlEncode2(e);G.share_page!==void 0&&(t="./index.php?share/fileGet&user="+G.user+"&sid="+G.sid+"&filename="+urlEncode2(e)),$.ajax({url:t,dataType:"json",beforeSend:function(){core.tips.loading(LNG.loading)},error:core.ajaxError,success:function(e){core.tips.close(LNG.success),"function"==typeof a&&a(e.data.content)}})},path_select:function(e,a,t){var i=UUID(),n="./index.php?/explorer&type=iframe&path_select="+e+"&uuid_key="+i,o=$.dialog.open(n,{id:i,resize:!0,fixed:!0,ico:core.ico("folder"),title:a,width:840,height:420,ok:function(){if("function"==typeof t){var e=o.DOM.wrap,a=e.find(".path_select_input").val();a&&t(a)}},cancel:!0}),s=o.DOM.wrap;s.find(".aui_buttons").css("padding","15px"),$('<input type="text" class="path_select_input"/>').insertBefore(s.find(".aui_state_highlight"))},path_select_change:function(e,a){var t=$("."+e).find(".path_select_input");t.val(a).textFocus()},setting:function(e){void 0==e&&(e=G.is_root?"system":"user");var a=share.system_top();void 0==a.frames.Opensetting_mode?$.dialog.open("./index.php?setting#"+e,{id:"setting_mode",fixed:!0,ico:core.ico("setting"),resize:!0,title:LNG.setting,width:960,height:600}):($.dialog.list.setting_mode.display(!0),FrameCall.top("Opensetting_mode","Setting.setGoto",'"'+e+'"'))},copyright:function(){var e=require("../tpl/copyright.html"),a=template.compile(e),t=a({LNG:LNG,G:G});art.dialog.through({id:"copyright_dialog",bottom:0,right:0,simple:!0,resize:!1,title:LNG.about+" kod",width:425,padding:"0",fixed:!0,content:t}),$(".copyright_dialog").addClass("animated-700 zoomIn")},qrcode:function(e){"./"==e.substr(0,2)&&(e=G.app_host+e.substr(2));var a="./index.php?user/qrcode&url="+urlEncode(e),t="<a href='"+e+"' target='_blank'><img src='"+a+"' style='border:1px solid #eee;'/></a>";$.dialog({fixed:!0,resize:!1,title:LNG.qrcode,padding:30,content:t})},appStore:function(){$.dialog.open("./index.php?app",{id:"app_store",fixed:!0,ico:core.ico("appStore"),resize:!0,title:LNG.app_store,width:900,height:550})},openIE:function(e){$.dialog.open(e,{fixed:!0,resize:!0,title:LNG.app_store,width:"80%",height:"70%"})},openApp:function(app){if("url"==app.type){var icon=app.icon;-1==app.icon.search(G.static_path)&&"http"!=app.icon.substring(0,4)&&(icon=G.static_path+"images/app/"+app.icon),app.width="number"!=typeof app.width&&-1==app.width.search("%")?parseInt(app.width):"80%","number"!=typeof app.height&&-1==app.height.search("%")?app.height=parseInt(app.height):app.width="60%";var dialog_info={resize:app.resize,fixed:!0,ico:icon,title:app.name.replace(".oexe",""),width:app.width,height:app.height,simple:app.simple,padding:0};"swf"==core.pathExt(app.content)?(dialog_info.content=core.createFlash(app.content),$.dialog(dialog_info)):$.dialog.open(app.content,dialog_info)}else{var exec=app.content;eval("{"+exec+"}")}},update:function(e){setTimeout(function(){var a=base64_decode("aHR0cDovL3N0YXRpYy5rYWxjYWRkbGUuY29tL3VwZGF0ZS9tYWluLmpz")+"?a="+UUID();require.async(a,function(a){try{a.todo(e)}catch(t){}})},3e3)},open_path:function(e){"undefined"!=typeof Config&&"explorer"==Config.pageApp?ui.path.list(e,"tips"):core.explorer(e)},explorer:function(e,a){void 0==e&&(e=""),void 0==a&&(a=core.pathThis(e));var t="./index.php?/explorer&type=iframe&path="+e;G.share_page!==void 0&&(t="./index.php?share/folder&type=iframe&user="+G.user+"&sid="+G.sid+"&path="+e),$.dialog.open(t,{resize:!0,fixed:!0,ico:core.ico("folder"),title:a,width:880,height:550})},explorerCode:function(e){void 0==e&&(e="");var a="index.php?/editor&project="+e;G.share_page!==void 0&&(a="./index.php?share/code_read&user="+G.user+"&sid="+G.sid+"&project="+e),window.open(a)},setSkin_finished:function(){var e=$(".setSkin_finished").attr("src");e&&($("#link_css_list").attr("href",e),$(".setSkin_finished").remove())},setSkin:function(e){var a=G.static_path+"style/skin/"+e+".css";$("body").append('<img src="'+a+'" onload="core.setSkin_finished();" onerror="core.setSkin_finished();" class="setSkin_finished">')},editorFull:function(){var e=$("iframe[name=OpenopenEditor]");e.toggleClass("frame_fullscreen")},language:function(e){Cookie.set("kod_user_language",e,8760),window.location.reload()},tips:{topHeight:function(){return 1==$(".topbar").length?$(".topbar").height():0},loading:function(e){Tips.loading(e,"info",core.tips.topHeight())},close:function(e,a){"object"==typeof e?Tips.close(e.data,e.code,core.tips.topHeight()):Tips.close(e,a,core.tips.topHeight())},tips:function(e,a){"object"==typeof e?Tips.tips(e.data,e.code,core.tips.topHeight()):Tips.tips(e,a,core.tips.topHeight())}},fullScreen:function(){"true"==$("body").attr("fullScreen")&&core.exitfullScreen(),$("body").attr("fullScreen","true");var e=share.system_top(),a=e.document.documentElement;a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()},exitfullScreen:function(){$("body").attr("fullScreen","false"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},createFlash:function(e,a,t){var i=UUID();(t===void 0||""==t)&&(t=i);var n='<object type="application/x-shockwave-flash" class="'+i+'" id="'+t+'" data="'+e+'" width="100%" height="100%">'+'<param name="movie" value="'+e+'"/>'+'<param name="allowfullscreen" value="true" />'+'<param name="allowscriptaccess" value="always" />'+'<param name="flashvars" value="'+a+'" />'+'<param name="wmode" value="transparent" />'+'</object><div class="aui_loading" id="'+i+'_loading"><span>loading..</span></div>';return setTimeout(function(){var e=$("."+i);if(1!=e.length){var a=share.system_top();e=a.$("."+i)}if(1==e.length)var t=0,n=e[0],o=setInterval(function(){try{t++,100==Math.floor(n.PercentLoaded())?(e.next(".aui_loading").remove(),clearInterval(o),o=null):t>100&&(e.next(".aui_loading").remove(),clearInterval(o),o=null)}catch(a){}},100)},50),n},search:function(e,a){var t,i,n=require("../tpl/search.html"),o=require("../tpl/search_list.html"),s=function(){var o=trim(core.pathClear(a),"/");if(0==o.indexOf(G.KOD_USER_SHARE)&&-1==o.indexOf("/"))return core.tips.tips(LNG.path_cannot_search,!1),void 0;var s=template.compile(n);0==$(".dialog_do_search").length?(c(),i={search:e,path:a,is_content:void 0,is_case:void 0,ext:""},"editor"==Config.pageApp&&(i.is_content=1,i.is_case=1),t=$.dialog({id:"dialog_do_search",padding:0,fixed:!0,ico:core.ico("search"),resize:!0,title:LNG.search,height:480,content:s({param:i,LNG:LNG})}),l(i),$("#search_ext").tooltip({placement:"bottom",html:!0}),$("#search_path").tooltip({placement:"bottom",html:!0,title:function(){return $("#search_path").val()}})):($("#search_value").val(e),$("#search_path").val(a),r(),$.dialog.list.dialog_do_search.display(!0))},r=function(){i={search:$("#search_value").val(),path:$("#search_path").val(),is_content:$("#search_is_content").attr("checked"),is_case:$("#search_is_case").attr("checked"),ext:$("#search_ext").val()},l(i)},c=function(){$("#search_value").die("keyup").live("keyup",function(){"editor"==!Config.pageApp&&ui.path.setSearchByStr($(this).val())}),$("#search_value,#search_ext,#search_path").keyEnter(r),$(".search_header a.button").die("click").live("click",r),$(".search_result .list .name a").die("click").live("click",function(){var e=$(this).parent().parent().attr("data-path"),a=$(this).parent().parent().attr("data-type");if($(this).parent().parent().hasClass("file")){var t=core.pathExt(e);(inArray(core.filetype.text,t)||inArray(core.filetype.code,t))&&share.data("FILE_SEARCH_KEY",{key:$("#search_value").val(),line:$(this).parent().attr("data-line")}),ui.pathOpen.open(e,a)}else core.open_path(e+"/")}),$(".search_result .list .path a").die("click").live("click",function(){var e=core.pathFather($(this).html());core.open_path(e)})},l=function(e){var a=150;$("#search_value").textFocus(),$(".search_result .list").remove();var t=$(".search_result .message td");if(!e.search||!e.path)return t.hide().html(LNG.search_info).fadeIn(a),void 0;e.search=urlEncode(e.search),e.path=urlEncode(e.path);var i="index.php?explorer/search";G.share_page!==void 0&&(i="index.php?share/search&user="+G.user+"&sid="+G.sid),$.ajax({url:i,dataType:"json",type:"POST",data:e,beforeSend:function(){t.hide().html(LNG.searching+'<img src="'+G.static_path+'images/loading.gif">').fadeIn(a)},error:core.ajaxError,success:function(e){if(!e.code)return t.hide().html(e.data).fadeIn(a),void 0;if(0==e.data.filelist.length&&0==e.data.folderlist.length)return t.hide().html(LNG.search_null).fadeIn(a),void 0;t.hide();var i=template.compile(o);for(var n in e.data)if("filelist"==n||"folderlist"==n)for(var s=0;e.data[n].length>s;s++)e.data[n][s].size=core.file_size(e.data[n][s].size);e.data.LNG=LNG,$(i(e.data)).insertAfter(".search_result .message")}})};s()},server_dwonload:function(e,a){core.upload_check("explorer:serverDownload");var t=$(".download_box"),i=t.find("#download_list");if(t.find("input").val(""),!e||"http"!=e.substr(0,4))return core.tips.tips("url false!",!1),void 0;var n=UUID(),o='<div id="'+n+'" class="item">'+'<div class="info"><span class="title" tytle="'+e+'">'+core.pathThis(e)+"</span>"+'<span class="size">0b</span>'+'<span class="state">'+LNG.upload_ready+"</span>"+'<a class="remove font-icon icon-remove" href="javascript:void(0)"></a>'+'<div style="clear:both"></div></div></div>';i.find(".item").length>0?$(o).insertBefore(i.find(".item:eq(0)")):i.append(o);var s,r,c,l=0,d=$("#"+n),p=$("#"+n+" .state").text(LNG.download_ready),u=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%;text-align:right;"></div></div>').appendTo("#"+n).find(".progress-bar");$("#"+n+" .remove").bind("click",function(){clearInterval(s),s=!1,clearTimeout(r),r=!1,$.get("./index.php?explorer/serverDownload&type=remove&uuid="+n),$(this).parent().parent().slideUp(function(){$(this).remove(),ui.f5()})}),$.ajax({url:"./index.php?explorer/serverDownload&type=download&save_path="+a+"&url="+urlEncode2(e)+"&uuid="+n,dataType:"json",error:function(e,a,t){core.ajaxError(e,a,t),clearInterval(s),s=!1,clearTimeout(r),r=!1,u.parent().remove(),p.addClass("error").text(LNG.download_error)},success:function(e){clearInterval(s),s=!1,clearTimeout(r),r=!1,e.code?(ui.f5_callback(function(){ui.path.setSelectByFilename(e.info)}),p.text(LNG.download_success),$("#"+n+" .info .title").html(e.info)):p.addClass("error").text(LNG.error),u.parent().remove()}});var h=function(){$.ajax({url:"./index.php?explorer/serverDownload&type=percent&uuid="+n,dataType:"json",success:function(e){var a="",t=e.data;if(s){if(!e.code)return p.text(LNG.loading),void 0;if(t){if(t.size=parseFloat(t.size),t.time=parseFloat(t.time),c){var i=(t.size-c.size)/(t.time-c.time);if(l>.2*i){var n=l;l=i,i=n}else l=i;a=core.file_size(i)+"/s"}if(0==t.length)d.find(".progress-bar").css("width","100%").text(LNG.loading);else{var o=100*(t.size/t.length);d.find(".progress-bar").css("width",o+"%"),p.text(parseInt(o)+"%("+a+")")}d.find(".size").text(core.file_size(t.length)),c=t}}}})};r=setTimeout(function(){h(),s=setInterval(function(){h()},1e3)},100)},user_space_html:function(e){var a=e.split("/"),t=parseFloat(a[0]),i=1073741824*parseFloat(a[1]),n=core.file_size(parseFloat(a[0])),o=core.file_size(i),s=n+"/",r=100*t/i;return r>=100&&(r=100),0==i||isNaN(i)?(s+=LNG.space_tips_full,r="0%"):(s+=o,r+="%"),s="<div class='space_info_bar'><div class='space_process'><div class='space_process_use' style='width:"+r+"'></div></div>"+"<div class='space_info'>"+s+"</div>"+"</div>"},file_size:function(e,a){if(void 0==e&&(e=0),void 0==a&&(a=1),1024>=e)return parseInt(e)+"B";e=parseInt(e);var t={G:1073741824,M:1048576,K:1024,B:1};for(var i in t)if(e>=t[i])return(e/t[i]).toFixed(a)+i},upload_check:function(e){return"share"==G.share_page?"1"==G.share_info.can_upload:(void 0==e&&(e="explorer:fileUpload"),!G.is_root&&AUTH.hasOwnProperty(e)&&1!=AUTH[e]?(core.tips.tips(LNG.no_permission,!1),!1):G.json_data&&!G.json_data.info.can_upload?(core.tips.tips(LNG.no_permission_write,!1),!1):!0)},upload:function(){var e="index.php?explorer/fileUpload";if("share"==G.share_page&&"1"==G.share_info.can_upload&&(e="index.php?share/fileUpload&user="+G.user+"&sid="+G.sid),uploader.option("server",e),0!=$(".dialog_file_upload").length)return $.dialog.list.dialog_file_upload.display(!0),void 0;var a=require("../tpl/upload.html"),t=template.compile(a),i=WebUploader.Base.formatSize(G.upload_max);$.dialog({padding:5,resize:!0,ico:core.ico("upload"),id:"dialog_file_upload",fixed:!0,title:LNG.upload_muti,content:t({LNG:LNG,maxsize:i}),close:function(){$.each(uploader.getFiles(),function(e,a){uploader.skipFile(a),uploader.removeFile(a)}),$.each($("#download_list .item"),function(){$(this).find(".remove").click()})}}),$(".file_upload .tips").tooltip({placement:"bottom"}),$(".file_upload .top_nav a.menu").unbind("click").bind("click",function(){$(this).hasClass("tab_upload")?($(".file_upload .tab_upload").addClass("this"),$(".file_upload .tab_download").removeClass("this"),$(".file_upload .upload_box").removeClass("hidden"),$(".file_upload .download_box").addClass("hidden")):($(".file_upload .tab_upload").removeClass("this"),$(".file_upload .tab_download").addClass("this"),$(".file_upload .upload_box").addClass("hidden"),$(".file_upload .download_box").removeClass("hidden"))}),$(".file_upload .download_box .download_start").unbind("click").bind("click",function(){core.server_dwonload($(".download_box input").val(),G.this_path)}),$(".file_upload .download_box .download_start_all").unbind("click").bind("click",function(){$.dialog({id:"server_dwonload_textarea",fixed:!0,resize:!1,ico:core.ico("upload"),width:"420px",height:"270px",padding:10,title:LNG.download,content:"<textarea style='width:400px;height:250px;border:1px solid #ddd;'></textarea>",ok:function(){for(var e=$(".server_dwonload_textarea textarea").val().split("\n"),a=0;e.length>a;a++)core.server_dwonload(e[a],G.this_path)}})}),"share"==G.share_page&&$(".top_nav").addClass("hidden"),uploader.addButton({id:"#picker"})},upload_init:function(){var e="#thelist",a=!0;$.browser.msie&&(a=!1);var t=10485760;t>=G.upload_max&&(t=.5*G.upload_max),uploader=WebUploader.create({swf:G.static_path+"js/lib/webuploader/Uploader.swf",dnd:"body",threads:2,compress:!1,resize:!1,prepareNextFile:!0,duplicate:!0,chunked:a,chunkRetry:3,chunkSize:t}),$("#uploader .success").die("click").live("click",function(){var e=$(this).find("span.title").attr("title");"explorer"==Config.pageApp?ui.path.list(core.pathFather(e),"tips",function(){ui.path.setSelectByFilename(core.pathThis(e))}):core.explorer(core.pathFather(e))}),$("#uploader .open").die("click").live("click",function(e){var a=$(this).find("span.title").attr("title");ui.pathOpen.open(a),stopPP(e)}),$(".upload_box_clear").die("click").live("click",function(){$("#thelist .item.success,#thelist .item.error").each(function(){$(this).slideUp(300,function(){$(this).remove()})})}),$("#uploader .remove").die("click").live("click",function(e){var a=$(this).parent().parent().attr("id");$(this).parent().parent().slideUp(function(){$(this).remove()}),uploader.skipFile(a),uploader.removeFile(a,!0),stopPP(e)});var i=0,n=0,o="0B/s",s=0,r=function(e,a){if(.3>=time_float()-s)return o;s=time_float();var t=e.size*a,i=5;e.speed===void 0?e.speed=[[time_float()-.5,0],[time_float(),t]]:i>=e.speed.length?e.speed.push([time_float(),t]):(e.speed=e.speed.slice(1,i),e.speed.push([time_float(),t]));var n=e.speed[e.speed.length-1],r=e.speed[0],c=(n[1]-r[1])/(n[0]-r[0]);return c=core.file_size(c)+"/s",o=c,c},c=[];uploader.on("fileQueued",function(a){if(!core.upload_check())return uploader.skipFile(a),uploader.removeFile(a),void 0;var t,n=$(e),t=a.fullPath;a.finished=!1,a.upload_to=urlDecode(G.this_path),(void 0==t||"undefined"==t)&&(t=a.name),i++,$(e).find(".item").length>0&&(n=$(e).find(".item:eq(0)"));var o='<div id="'+a.id+'" class="item"><div class="info">'+'<span class="title" title="'+G.this_path+t+'">'+core.pathThis(t)+"</span>"+'<span class="size">'+core.file_size(a.size)+"</span>"+'<span class="state">'+LNG.upload_ready+"</span>"+'<a class="remove font-icon icon-remove" href="javascript:void(0)"></a>'+'<div style="clear:both"></div></div></div>';$(e).find(".item").length>0?$(o).insertBefore($(e).find(".item:eq(0)")):$(e).append(o),uploader.upload()}).on("uploadBeforeSend",function(e,a){var t=urlEncode(e.file.fullPath);(void 0==t||"undefined"==t)&&(t=""),a.fullPath=t,a.upload_to=e.file.upload_to}).on("uploadProgress",function(e,a){$(".dialog_file_upload .aui_title").text(LNG.uploading+": "+n+"/"+i+" ("+o+")");var t=r(e,a),s=$("#"+e.id),c=s.find(".progress .progress-bar");c.length||(c=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(s).find(".progress-bar")),s.find(".state").text(parseInt(100*a)+"%("+t+")"),c.css("width",100*a+"%")}).on("uploadAccept",function(e,a){e.file.serverData=a;try{c.push(core.pathThis(a.info))}catch(t){}}).on("uploadSuccess",function(e){var a=36*$("#"+e.id).index(".item");$("#uploader").scrollTop(a),n++;var t=e.serverData;if(t.code?($("#"+e.id).addClass("success"),$("#"+e.id).find(".state").text(t.data),$("#"+e.id).find(".remove").removeClass("icon-remove").addClass("icon-ok").addClass("open").removeClass("remove")):($("#"+e.id).addClass("error").find(".state").addClass("error"),$("#"+e.id).find(".state").text(t.data).attr("title",t.data)),uploader.removeFile(e),$("#"+e.id).find(".progress").fadeOut(),!e.fullPath){var i=c;ui.f5_callback(function(){ui.path.setSelectByFilename(i)})}}).on("uploadError",function(e,a){n++,$("#"+e.id).find(".progress").fadeOut(),$("#"+e.id).addClass("error").find(".state").addClass("error"),$("#"+e.id).find(".state").text(LNG.upload_error+"("+a+")")}).on("uploadFinished",function(){$(".dialog_file_upload .aui_title").text(LNG.upload_success+": "+n+"/"+i),i=0,n=0,uploader.reset();var e=c;if(ui.f5_callback(function(){ui.path.setSelectByFilename(e),c=[]}),"explorer"==Config.pageApp){if("share"==G.share_page)return;ui.tree.checkIfChange(G.this_path)}}).on("error",function(e){core.tips.tips(e,!1)});var l;inState=!1,dragOver=function(){0==inState&&(inState=!0,MaskView.tips(LNG.upload_drag_tips)),l&&window.clearTimeout(l)},dragLeave=function(e){stopPP(e),l&&window.clearTimeout(l),l=window.setTimeout(function(){inState=!1,MaskView.close()},100)},dragDrop=function(e){try{if(e=e.originalEvent||e,core.upload_check()){var a=e.dataTransfer.getData("text/plain");a&&"http"==a.substring(0,4)?ui.pathOperate.appAddURL(a):core.upload()}stopPP(e)}catch(e){}inState&&(inState=!1,MaskView.close())}}}}),define("app/tpl/copyright.html",[],'<div class="copyright_dialog_content">\n	<div class="title">\n		<div class="logo"><i class="icon-cloud"></i>KodExplorer v{{G.version}}</div>\n		<div class=\'info\'>——{{LNG.kod_name_copyright}}</div>\n	</div>\n	<div class="content">\n		<p>{{#LNG.copyright_desc}}</p>\n		<div>{{#LNG.copyright_contact}}</div>\n		<div>{{#LNG.copyright_info}}</div> \n	</div>\n</div>'),define("app/tpl/search.html",[],"<div class='do_search'>\n    <div class='search_header'>\n       <div class='s_br'>\n            <input type='text' id='search_value' value='{{param.search}}'/><a class='right button icon-search'></a>\n            <div style='float:right'>{{LNG.path}}:<input type='text' id='search_path' value='{{param.path}}'/></div>\n        </div>\n       <div class='s_br'>\n            <input type='checkbox' id='search_is_case' {{if param.is_case}}checked='true'{{/if}}/>\n            <label for='search_is_case'>{{LNG.search_uplow}}</label>\n            <input type='checkbox' id='search_is_content' {{if param.is_content}}checked='true'{{/if}}/>\n            <label for='search_is_content'>{{LNG.search_content}}</label>\n            <div style='float:right'>{{LNG.file_type}}:<input type='text' id='search_ext' value='{{param.ext}}' title='{{LNG.search_ext_tips}}'/></div>\n        </div>\n    </div>\n    <div class='search_result'>\n        <table border='0' cellspacing='0' cellpadding='0'>\n            <tr class='search_title'>\n               <td class='name'>{{LNG.name}}</td>\n               <td class='type'>{{LNG.type}}</td>\n               <td class='size'>{{LNG.size}}</td>\n               <td class='path'>{{LNG.path}}</td>\n            </tr>\n            <tr class='message'><td colspan='4'></td></tr>\n        </table>\n    </div>\n</div>\n\n"),define("app/tpl/search_list.html",[],"{{each folderlist as v i}}\n    <tr class='list folder' data-path='{{v.path}}' data-type='folder' data-size='0'>\n        <td class='name'><a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a></td>\n        <td class='type'>{{LNG.folder}}</td>\n        <td class='size'>0</td>\n        <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>\n    </tr>\n{{/each}}\n{{each filelist as v i}}\n<tr class='list file'\n    data-path='{{v.path}}' \n    data-type='{{v.ext}}' \n    data-size='{{v.size}}'>\n    <td class='name' data-line=\"{{if v.search_line}}{{v.search_line}}{{/if}}\">\n        <a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a> \n        {{if v.search_line}}<span>&nbsp;({{v.search_line}})</span>{{/if}}\n    </td>\n    <td class='type'>{{v.ext}}</td>\n    <td class='size'>{{v.size}}</td>\n    <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>\n</tr>\n{{/each}}"),define("app/tpl/upload.html",[],"<div class='file_upload'>\n    <div class='top_nav'>\n       <a href='javascript:void(0);' class='menu this tab_upload'>{{LNG.upload_local}}</a>\n       <a href='javascript:void(0);' class='menu tab_download''>{{LNG.download_from_server}}</a>\n       <div style='clear:both'></div>\n    </div>\n    <div class='upload_box'>\n        <div class='btns'>\n            <div id='picker'>{{LNG.upload_select}}</div>\n            <div class=\"upload_box_tips\">\n            <a href=\"javascript:void(0);\" class=\"upload_box_clear\">{{LNG.upload_clear}}</a> \n            </div>\n            <div style='clear:both'></div>\n        </div>\n        <div id='uploader' class='wu-example'>\n            <div id='thelist' class='uploader-list'></div>\n        </div>\n    </div>\n    <div class='download_box hidden'>\n        <div class='list'>{{LNG.download_address}}<input type='text' name='url'/>\n\n        <div class=\"download_btn_group btn-group\">\n          <button class='btn btn-default btn-sm download_start' type='button'>{{LNG.download}}</button>\n          <button type=\"button\" class=\"btn btn-default btn-sm dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n            <span class=\"caret\"></span>&nbsp;\n            <span class=\"sr-only\">Dropdown</span>\n          </button>\n          <ul class=\"dropdown-menu\">\n            <li><a href=\"javascript:void(0);\" class=\"download_start_all\">批量添加</a></li>\n          </ul>\n        </div>\n\n        </div>\n        <div style='clear:both'></div>\n        <div id='downloader'>\n            <div id='download_list' class='uploader-list'></div>\n        </div>\n    </div>\n</div>"),define("app/src/app/page",[],function(){var e,a=function(){e=location.hash.split("#",2)[1],e||(e="all"),i(e),$("ul.setting a").click(function(){e!=$(this).attr("id")&&(e=$(this).attr("id"),i(e))}),$(".box .list").live("hover",function(){$(this).addClass("listhover")},function(){$(this).toggleClass("listhover")}).live("click",function(){var e="index.php?setting/set&k="+type+"&v="+value;$.ajax({url:e,dataType:"json",success:function(e){tips(e.data,e.code)}})}),$("a.create_app").bind("click",function(){FrameCall.father("ui.path.pathOperate.appEdit",'"","","root_add"')}),$(".app-list .app_li").die("click").live("click",function(e){if($(e.target).attr("action")){var a=json_decode(urlDecode($(this).attr("data"))),t=$(e.target).attr("action");switch(t){case"preview":core.openApp(a);break;case"add":FrameCall.father("get","G.this_path");var n=share.data("create_app_path"),o=urlEncode(n+a.name),s="./index.php?app/user_app&action=add&path="+o;$.ajax({url:s,dataType:"json",type:"POST",data:"data="+urlEncode2(json_encode(a)),error:core.ajaxError,success:function(e){tips(e.data,e.code),e.code&&FrameCall.father("ui.f5","")}});break;case"edit":window.parent&&window.parent.ui.path.pathOperate.appEdit(a,"","root_edit");break;case"del":$.dialog({id:"dialog_app_remove",fixed:!0,icon:"question",padding:20,width:200,lock:!0,background:"#000",opacity:.3,content:LNG.remove_info,ok:function(){$.ajax({url:"./index.php?app/del&name="+urlEncode(a.name),dataType:"json",error:core.ajaxError,success:function(e){tips(e.data,e.code),e.code&&i()}})},cancel:!0});break;default:}}})},t=function(e){var a="",t="<button type='button' class='btn btn-sm btn-default dropdown-toggle' data-toggle='dropdown'>				    <span class='caret'></span>				    <span class='sr-only'>Toggle Dropdown</span>				</button>				<ul class='dropdown-menu' role='menu'>					<li><a action='edit' href='javascript:;'>"+LNG.button_edit+"</a></li>					<li><a action='del' href='javascript:;'>"+LNG.button_del+"</a></li>				</ul>";G.is_root||(t="");for(var i in e){var n=e[i].icon;-1==n.search(G.static_path)&&"http"!=n.substring(0,4)&&(n=G.static_path+"images/app/"+n),a+="<li class='app_li' data="+urlEncode(json_encode(e[i]))+">				<a action='preview' href='javascript:;' class='icon'><img action='preview' src='"+n+"'></a>				<p><span class='title'>"+e[i].name+"</span>				<span class='info'>"+e[i].desc+"</span></p>"+"<div class='btn-group'>				<button type='button' class='btn btn-sm btn-default' action='add'>"+LNG.button_add+"</button>"+t+"</div><div style='clear:both;'></div></li>"}return a+="<div style='clear:both;'></div>"},i=function(a){(void 0==a||""==a)&&(a=e),window.location.href="#"+a,$(".selected").removeClass("selected"),$("ul.setting a#"+a).addClass("selected"),$(".main").find(".h1").html($(".selected").html());var i=$(".main .app-list");$.ajax({url:"./index.php?app/get&group="+a,dataType:"json",beforeSend:function(){},success:function(e){i.html(t(e.data)),$("body").scrollTop(0)}})};return{reload:i,init:a}});