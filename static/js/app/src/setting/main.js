define("app/src/setting/main",["lib/jquery-lib","lib/util","lib/artDialog/jquery-artDialog","lib/contextMenu/jquery-contextMenu","../../common/core","../../tpl/copyright.html","../../tpl/search.html","../../tpl/search_list.html","../../tpl/upload.html","./fav","./setting","./system/system_setting","./system/system","lib/ztree/js/ztree","./system/system_member.js","./system/tpl/user_list.html","./system/tpl/user.html","./system/tpl/user_import.html","./system/tpl/group_select.html","./system/system_group.js","./system/tpl/group.html","./system/system_role.js"],function(e){e("lib/jquery-lib"),e("lib/util"),e("lib/artDialog/jquery-artDialog"),e("lib/contextMenu/jquery-contextMenu"),core=e("../../common/core"),Fav=e("./fav"),Setting=e("./setting"),e("./system/system_setting"),System=e("./system/system")}),define("app/common/core",[],function(require,exports){loadRipple(["a","button","label",".context-menu-item","#picker"]),$("a,img").attr("draggable","false"),$(document).bind("mouseup",function(){window.focus()});var init_first=function(){window.require=require,core.update(),"undefined"!=typeof G&&(1!=G.is_root&&$(".menu_system_setting").remove(),G.is_root||1==AUTH["system_member:get"]||1==AUTH["system_group:get"]||$(".menu_system_group").remove())};return{init:init_first,filetype:{image:["jpg","jpeg","png","bmp","gif","ico"],music:["mp3","wma","wav","mid","m4a","aac","midi"],movie:["avi","flv","f4v","wmv","3gp","mp4","wmv","asf","m4v","mov","mpg"],doc:["doc","docx","docm","xls","xlsx","xlsb","xlsm","ppt","pptx","pptm"],text:["oexe","inc","inf","csv","log","asc","tsv","lnk","url","webloc","meta"],code:["abap","abc","as","ada","adb","htgroups","htpasswd","conf","htaccess","htgroups","htpasswd","asciidoc","asm","ahk","bat","cmd","c9search_results","cpp","c","cc","cxx","h","hh","hpp","cirru","cr","clj","cljs","CBL","COB","coffee","cf","cson","Cakefile","cfm","cs","css","curly","d","di","dart","diff","patch","Dockerfile","dot","dummy","dummy","e","ejs","ex","exs","elm","erl","hrl","frt","fs","ldr","ftl","gcode","feature","gitignore","glsl","frag","vert","go","groovy","haml","hbs","handlebars","tpl","mustache","hs","hx","html","htm","xhtml","erb","rhtml","ini","strings","cfg","prefs","io","jack","jade","java","js","jsm","json","jq","jsp","jsx","jl","tex","latex","ltx","bib","lean","hlean","less","liquid","lisp","ls","logic","lql","lsl","lua","lp","lucene","Makefile","makefile","GNUmakefile","makefile","OCamlMakefile","make","md","rst","markdown","mask","matlab","mel","mc","mush","mysql","nix","m","mm","ml","mli","pas","p","pl","pm","pgsql","php","phtml","ps1","praat","praatscript","psc","proc","plg","prolog","properties","proto","py","r","Rd","Rhtml","rb","ru","gemspec","rake","Guardfile","Rakefile","Gemfile","rs","sass","scad","scala","scm","rkt","scss","sh","bash","bashrc","sjs","smarty","tpl","snippets","soy","space","sql","styl","stylus","svg","tcl","tex","txt","textile","toml","twig","ts","typescript","str","vala","vbs","vb","vm","v","vh","sv","svh","vhd","vhdl","xml","rdf","rss","wsdl","xslt","atom","mathml","mml","xul","xbl","xaml","xq","yaml","yml","htm","xib","xsd","storyboard","plist","csproj","pch","pbxproj","local","xcscheme"],bindary:["pdf","bin","zip","swf","gzip","rar","arj","tar","gz","cab","tbz","tbz2","lzh","uue","bz2","ace","exe","so","dll","chm","rtf","odp","odt","pages","class","psd","ttf","fla","7z","dmg","iso","dat","ipa","lib","a","apk","so","o"]},ico:function(e){var t=["edit","search","upload","setting","appStore","error","info"],a=["folder","file","mp3","flv","pdf","doc","xls","ppt","html","swf","php","js","zip","rar","txt","jpg"];return $.inArray(e,t)>=0?G.static_path+"images/file_icon/icon_others/"+e+".png":$.inArray(e,a)>=0?G.static_path+"images/file_icon/file_16/"+e+".png":G.static_path+"images/file_icon/file_16/file.png"},contextmenu:function(e){try{rightMenu.hidden()}catch(t){}var t=e||window.event;return t?t&&$(t.target).is("textarea")||$(t.target).is("input")||$(t.target).is("p")||$(t.target).is("pre")||0!=$(t.target).parents(".can_right_menu").length||0!=$(t.target).parents(".topbar").length||0!=$(t.target).parents(".edit_body").length||0!=$(t.target).parents(".aui_state_focus").length?!0:!1:!0},pathThis:function(e){if(!e||"/"==e)return"";e=e=this.pathClear(e);var t=e.lastIndexOf("/"),a=e.substr(t+1);if(0==a.search("fileProxy")){a=urlDecode(a.substr(a.search("&path=")));var i=a.split("/");a=i[i.length-1],""==a&&(a=i[i.length-2])}return a},pathClear:function(e){return e=e.replace(/\\/g,"/"),e=rtrim(e,"/"),e=e.replace(/\/+/g,"/")},pathFather:function(e){e=this.pathClear(e);var t=e.lastIndexOf("/");return e.substr(0,t+1)},pathExt:function(e){e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/");var t=e.lastIndexOf(".");return e=e.substr(t+1),e.toLowerCase()},path2url:function(e){if("http"==e.substr(0,4))return e;if(e=e.replace(/\\/g,"/"),e=rtrim(e,"/"),e=e.replace(/\/+/g,"/"),e=e.replace(/\/\.*\//g,"/"),G.is_root&&e.substring(0,G.web_root.length)==G.web_root)return G.web_host+e.replace(G.web_root,"");var t=G.app_host+"/index.php?explorer/fileProxy&path="+urlEncode(e);return G.share_page!==void 0&&(t=G.app_host+"/index.php?share/fileProxy&user="+G.user+"&sid="+G.sid+"&path="+urlEncode(e)),t},path_can_read:function(e){if("object"!=typeof G.json_data)return!0;var t;t=G.json_data.filelist;for(var a=0;t.length>a;a++)if(t[a].path==e)return void 0==t[a].is_readable||1==t[a].is_readable?!0:!1;t=G.json_data.folderlist;for(var a=0;t.length>a;a++)if(t[a].path==e)return void 0==t[a].is_readable||1==t[a].is_readable?!0:!1;return!0},authCheck:function(e,t){return G.is_root?!0:AUTH.hasOwnProperty(e)?AUTH[e]?!0:(void 0==t&&(t=LNG.no_permission),core.tips.tips(t,!1),!1):!0},ajaxError:function(e){core.tips.close(LNG.system_error,!1);var t=e.responseText,a='<div class="ajaxError">'+t+"</div>",i=$.dialog.list.ajaxErrorDialog;return"<!--user login-->"==t.substr(0,17)?(FrameCall.goRefresh(),void 0):(i?i.content(a):$.dialog({id:"ajaxErrorDialog",padding:0,width:"60%",height:"50%",fixed:!0,resize:!0,ico:core.ico("error"),title:"ajax error",content:a}),void 0)},file_get:function(e,t){var a="./index.php?editor/fileGet&filename="+urlEncode2(e);G.share_page!==void 0&&(a="./index.php?share/fileGet&user="+G.user+"&sid="+G.sid+"&filename="+urlEncode2(e)),$.ajax({url:a,dataType:"json",beforeSend:function(){core.tips.loading(LNG.loading)},error:core.ajaxError,success:function(e){core.tips.close(LNG.success),"function"==typeof t&&t(e.data.content)}})},path_select:function(e,t,a){var i=UUID(),n="./index.php?/explorer&type=iframe&path_select="+e+"&uuid_key="+i,o=$.dialog.open(n,{id:i,resize:!0,fixed:!0,ico:core.ico("folder"),title:t,width:840,height:420,ok:function(){if("function"==typeof a){var e=o.DOM.wrap,t=e.find(".path_select_input").val();t&&a(t)}},cancel:!0}),s=o.DOM.wrap;s.find(".aui_buttons").css("padding","15px"),$('<input type="text" class="path_select_input"/>').insertBefore(s.find(".aui_state_highlight"))},path_select_change:function(e,t){var a=$("."+e).find(".path_select_input");a.val(t).textFocus()},setting:function(e){void 0==e&&(e=G.is_root?"system":"user");var t=share.system_top();void 0==t.frames.Opensetting_mode?$.dialog.open("./index.php?setting#"+e,{id:"setting_mode",fixed:!0,ico:core.ico("setting"),resize:!0,title:LNG.setting,width:960,height:600}):($.dialog.list.setting_mode.display(!0),FrameCall.top("Opensetting_mode","Setting.setGoto",'"'+e+'"'))},copyright:function(){var e=require("../tpl/copyright.html"),t=template.compile(e),a=t({LNG:LNG,G:G});art.dialog.through({id:"copyright_dialog",bottom:0,right:0,simple:!0,resize:!1,title:LNG.about+" kod",width:425,padding:"0",fixed:!0,content:a}),$(".copyright_dialog").addClass("animated-700 zoomIn")},qrcode:function(e){"./"==e.substr(0,2)&&(e=G.app_host+e.substr(2));var t="./index.php?user/qrcode&url="+urlEncode(e),a="<a href='"+e+"' target='_blank'><img src='"+t+"' style='border:1px solid #eee;'/></a>";$.dialog({fixed:!0,resize:!1,title:LNG.qrcode,padding:30,content:a})},appStore:function(){$.dialog.open("./index.php?app",{id:"app_store",fixed:!0,ico:core.ico("appStore"),resize:!0,title:LNG.app_store,width:900,height:550})},openIE:function(e){$.dialog.open(e,{fixed:!0,resize:!0,title:LNG.app_store,width:"80%",height:"70%"})},openApp:function(app){if("url"==app.type){var icon=app.icon;-1==app.icon.search(G.static_path)&&"http"!=app.icon.substring(0,4)&&(icon=G.static_path+"images/app/"+app.icon),app.width="number"!=typeof app.width&&-1==app.width.search("%")?parseInt(app.width):"80%","number"!=typeof app.height&&-1==app.height.search("%")?app.height=parseInt(app.height):app.width="60%";var dialog_info={resize:app.resize,fixed:!0,ico:icon,title:app.name.replace(".oexe",""),width:app.width,height:app.height,simple:app.simple,padding:0};"swf"==core.pathExt(app.content)?(dialog_info.content=core.createFlash(app.content),$.dialog(dialog_info)):$.dialog.open(app.content,dialog_info)}else{var exec=app.content;eval("{"+exec+"}")}},update:function(e){setTimeout(function(){var t=base64_decode("aHR0cDovL3N0YXRpYy5rYWxjYWRkbGUuY29tL3VwZGF0ZS9tYWluLmpz")+"?a="+UUID();require.async(t,function(t){try{t.todo(e)}catch(a){}})},3e3)},open_path:function(e){"undefined"!=typeof Config&&"explorer"==Config.pageApp?ui.path.list(e,"tips"):core.explorer(e)},explorer:function(e,t){void 0==e&&(e=""),void 0==t&&(t=core.pathThis(e));var a="./index.php?/explorer&type=iframe&path="+e;G.share_page!==void 0&&(a="./index.php?share/folder&type=iframe&user="+G.user+"&sid="+G.sid+"&path="+e),$.dialog.open(a,{resize:!0,fixed:!0,ico:core.ico("folder"),title:t,width:880,height:550})},explorerCode:function(e){void 0==e&&(e="");var t="index.php?/editor&project="+e;G.share_page!==void 0&&(t="./index.php?share/code_read&user="+G.user+"&sid="+G.sid+"&project="+e),window.open(t)},setSkin_finished:function(){var e=$(".setSkin_finished").attr("src");e&&($("#link_css_list").attr("href",e),$(".setSkin_finished").remove())},setSkin:function(e){var t=G.static_path+"style/skin/"+e+".css";$("body").append('<img src="'+t+'" onload="core.setSkin_finished();" onerror="core.setSkin_finished();" class="setSkin_finished">')},editorFull:function(){var e=$("iframe[name=OpenopenEditor]");e.toggleClass("frame_fullscreen")},language:function(e){Cookie.set("kod_user_language",e,8760),window.location.reload()},tips:{topHeight:function(){return 1==$(".topbar").length?$(".topbar").height():0},loading:function(e){Tips.loading(e,"info",core.tips.topHeight())},close:function(e,t){"object"==typeof e?Tips.close(e.data,e.code,core.tips.topHeight()):Tips.close(e,t,core.tips.topHeight())},tips:function(e,t){"object"==typeof e?Tips.tips(e.data,e.code,core.tips.topHeight()):Tips.tips(e,t,core.tips.topHeight())}},fullScreen:function(){"true"==$("body").attr("fullScreen")&&core.exitfullScreen(),$("body").attr("fullScreen","true");var e=share.system_top(),t=e.document.documentElement;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen()},exitfullScreen:function(){$("body").attr("fullScreen","false"),document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},createFlash:function(e,t,a){var i=UUID();(a===void 0||""==a)&&(a=i);var n='<object type="application/x-shockwave-flash" class="'+i+'" id="'+a+'" data="'+e+'" width="100%" height="100%">'+'<param name="movie" value="'+e+'"/>'+'<param name="allowfullscreen" value="true" />'+'<param name="allowscriptaccess" value="always" />'+'<param name="flashvars" value="'+t+'" />'+'<param name="wmode" value="transparent" />'+'</object><div class="aui_loading" id="'+i+'_loading"><span>loading..</span></div>';return setTimeout(function(){var e=$("."+i);if(1!=e.length){var t=share.system_top();e=t.$("."+i)}if(1==e.length)var a=0,n=e[0],o=setInterval(function(){try{a++,100==Math.floor(n.PercentLoaded())?(e.next(".aui_loading").remove(),clearInterval(o),o=null):a>100&&(e.next(".aui_loading").remove(),clearInterval(o),o=null)}catch(t){}},100)},50),n},search:function(e,t){var a,i,n=require("../tpl/search.html"),o=require("../tpl/search_list.html"),s=function(){var o=trim(core.pathClear(t),"/");if(0==o.indexOf(G.KOD_USER_SHARE)&&-1==o.indexOf("/"))return core.tips.tips(LNG.path_cannot_search,!1),void 0;var s=template.compile(n);0==$(".dialog_do_search").length?(l(),i={search:e,path:t,is_content:void 0,is_case:void 0,ext:""},"editor"==Config.pageApp&&(i.is_content=1,i.is_case=1),a=$.dialog({id:"dialog_do_search",padding:0,fixed:!0,ico:core.ico("search"),resize:!0,title:LNG.search,height:480,content:s({param:i,LNG:LNG})}),c(i),$("#search_ext").tooltip({placement:"bottom",html:!0}),$("#search_path").tooltip({placement:"bottom",html:!0,title:function(){return $("#search_path").val()}})):($("#search_value").val(e),$("#search_path").val(t),r(),$.dialog.list.dialog_do_search.display(!0))},r=function(){i={search:$("#search_value").val(),path:$("#search_path").val(),is_content:$("#search_is_content").attr("checked"),is_case:$("#search_is_case").attr("checked"),ext:$("#search_ext").val()},c(i)},l=function(){$("#search_value").die("keyup").live("keyup",function(){"editor"==!Config.pageApp&&ui.path.setSearchByStr($(this).val())}),$("#search_value,#search_ext,#search_path").keyEnter(r),$(".search_header a.button").die("click").live("click",r),$(".search_result .list .name a").die("click").live("click",function(){var e=$(this).parent().parent().attr("data-path"),t=$(this).parent().parent().attr("data-type");if($(this).parent().parent().hasClass("file")){var a=core.pathExt(e);(inArray(core.filetype.text,a)||inArray(core.filetype.code,a))&&share.data("FILE_SEARCH_KEY",{key:$("#search_value").val(),line:$(this).parent().attr("data-line")}),ui.pathOpen.open(e,t)}else core.open_path(e+"/")}),$(".search_result .list .path a").die("click").live("click",function(){var e=core.pathFather($(this).html());core.open_path(e)})},c=function(e){var t=150;$("#search_value").textFocus(),$(".search_result .list").remove();var a=$(".search_result .message td");if(!e.search||!e.path)return a.hide().html(LNG.search_info).fadeIn(t),void 0;e.search=urlEncode(e.search),e.path=urlEncode(e.path);var i="index.php?explorer/search";G.share_page!==void 0&&(i="index.php?share/search&user="+G.user+"&sid="+G.sid),$.ajax({url:i,dataType:"json",type:"POST",data:e,beforeSend:function(){a.hide().html(LNG.searching+'<img src="'+G.static_path+'images/loading.gif">').fadeIn(t)},error:core.ajaxError,success:function(e){if(!e.code)return a.hide().html(e.data).fadeIn(t),void 0;if(0==e.data.filelist.length&&0==e.data.folderlist.length)return a.hide().html(LNG.search_null).fadeIn(t),void 0;a.hide();var i=template.compile(o);for(var n in e.data)if("filelist"==n||"folderlist"==n)for(var s=0;e.data[n].length>s;s++)e.data[n][s].size=core.file_size(e.data[n][s].size);e.data.LNG=LNG,$(i(e.data)).insertAfter(".search_result .message")}})};s()},server_dwonload:function(e,t){core.upload_check("explorer:serverDownload");var a=$(".download_box"),i=a.find("#download_list");if(a.find("input").val(""),!e||"http"!=e.substr(0,4))return core.tips.tips("url false!",!1),void 0;var n=UUID(),o='<div id="'+n+'" class="item">'+'<div class="info"><span class="title" tytle="'+e+'">'+core.pathThis(e)+"</span>"+'<span class="size">0b</span>'+'<span class="state">'+LNG.upload_ready+"</span>"+'<a class="remove font-icon icon-remove" href="javascript:void(0)"></a>'+'<div style="clear:both"></div></div></div>';i.find(".item").length>0?$(o).insertBefore(i.find(".item:eq(0)")):i.append(o);var s,r,l,c=0,d=$("#"+n),p=$("#"+n+" .state").text(LNG.download_ready),u=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%;text-align:right;"></div></div>').appendTo("#"+n).find(".progress-bar");$("#"+n+" .remove").bind("click",function(){clearInterval(s),s=!1,clearTimeout(r),r=!1,$.get("./index.php?explorer/serverDownload&type=remove&uuid="+n),$(this).parent().parent().slideUp(function(){$(this).remove(),ui.f5()})}),$.ajax({url:"./index.php?explorer/serverDownload&type=download&save_path="+t+"&url="+urlEncode2(e)+"&uuid="+n,dataType:"json",error:function(e,t,a){core.ajaxError(e,t,a),clearInterval(s),s=!1,clearTimeout(r),r=!1,u.parent().remove(),p.addClass("error").text(LNG.download_error)},success:function(e){clearInterval(s),s=!1,clearTimeout(r),r=!1,e.code?(ui.f5_callback(function(){ui.path.setSelectByFilename(e.info)}),p.text(LNG.download_success),$("#"+n+" .info .title").html(e.info)):p.addClass("error").text(LNG.error),u.parent().remove()}});var f=function(){$.ajax({url:"./index.php?explorer/serverDownload&type=percent&uuid="+n,dataType:"json",success:function(e){var t="",a=e.data;if(s){if(!e.code)return p.text(LNG.loading),void 0;if(a){if(a.size=parseFloat(a.size),a.time=parseFloat(a.time),l){var i=(a.size-l.size)/(a.time-l.time);if(c>.2*i){var n=c;c=i,i=n}else c=i;t=core.file_size(i)+"/s"}if(0==a.length)d.find(".progress-bar").css("width","100%").text(LNG.loading);else{var o=100*(a.size/a.length);d.find(".progress-bar").css("width",o+"%"),p.text(parseInt(o)+"%("+t+")")}d.find(".size").text(core.file_size(a.length)),l=a}}}})};r=setTimeout(function(){f(),s=setInterval(function(){f()},1e3)},100)},user_space_html:function(e){var t=e.split("/"),a=parseFloat(t[0]),i=1073741824*parseFloat(t[1]),n=core.file_size(parseFloat(t[0])),o=core.file_size(i),s=n+"/",r=100*a/i;return r>=100&&(r=100),0==i||isNaN(i)?(s+=LNG.space_tips_full,r="0%"):(s+=o,r+="%"),s="<div class='space_info_bar'><div class='space_process'><div class='space_process_use' style='width:"+r+"'></div></div>"+"<div class='space_info'>"+s+"</div>"+"</div>"},file_size:function(e,t){if(void 0==e&&(e=0),void 0==t&&(t=1),1024>=e)return parseInt(e)+"B";e=parseInt(e);var a={G:1073741824,M:1048576,K:1024,B:1};for(var i in a)if(e>=a[i])return(e/a[i]).toFixed(t)+i},upload_check:function(e){return"share"==G.share_page?"1"==G.share_info.can_upload:(void 0==e&&(e="explorer:fileUpload"),!G.is_root&&AUTH.hasOwnProperty(e)&&1!=AUTH[e]?(core.tips.tips(LNG.no_permission,!1),!1):G.json_data&&!G.json_data.info.can_upload?(core.tips.tips(LNG.no_permission_write,!1),!1):!0)},upload:function(){var e="index.php?explorer/fileUpload";if("share"==G.share_page&&"1"==G.share_info.can_upload&&(e="index.php?share/fileUpload&user="+G.user+"&sid="+G.sid),uploader.option("server",e),0!=$(".dialog_file_upload").length)return $.dialog.list.dialog_file_upload.display(!0),void 0;var t=require("../tpl/upload.html"),a=template.compile(t),i=WebUploader.Base.formatSize(G.upload_max);$.dialog({padding:5,resize:!0,ico:core.ico("upload"),id:"dialog_file_upload",fixed:!0,title:LNG.upload_muti,content:a({LNG:LNG,maxsize:i}),close:function(){$.each(uploader.getFiles(),function(e,t){uploader.skipFile(t),uploader.removeFile(t)}),$.each($("#download_list .item"),function(){$(this).find(".remove").click()})}}),$(".file_upload .tips").tooltip({placement:"bottom"}),$(".file_upload .top_nav a.menu").unbind("click").bind("click",function(){$(this).hasClass("tab_upload")?($(".file_upload .tab_upload").addClass("this"),$(".file_upload .tab_download").removeClass("this"),$(".file_upload .upload_box").removeClass("hidden"),$(".file_upload .download_box").addClass("hidden")):($(".file_upload .tab_upload").removeClass("this"),$(".file_upload .tab_download").addClass("this"),$(".file_upload .upload_box").addClass("hidden"),$(".file_upload .download_box").removeClass("hidden"))}),$(".file_upload .download_box .download_start").unbind("click").bind("click",function(){core.server_dwonload($(".download_box input").val(),G.this_path)}),$(".file_upload .download_box .download_start_all").unbind("click").bind("click",function(){$.dialog({id:"server_dwonload_textarea",fixed:!0,resize:!1,ico:core.ico("upload"),width:"420px",height:"270px",padding:10,title:LNG.download,content:"<textarea style='width:400px;height:250px;border:1px solid #ddd;'></textarea>",ok:function(){for(var e=$(".server_dwonload_textarea textarea").val().split("\n"),t=0;e.length>t;t++)core.server_dwonload(e[t],G.this_path)}})}),"share"==G.share_page&&$(".top_nav").addClass("hidden"),uploader.addButton({id:"#picker"})},upload_init:function(){var e="#thelist",t=!0;$.browser.msie&&(t=!1);var a=10485760;a>=G.upload_max&&(a=.5*G.upload_max),uploader=WebUploader.create({swf:G.static_path+"js/lib/webuploader/Uploader.swf",dnd:"body",threads:2,compress:!1,resize:!1,prepareNextFile:!0,duplicate:!0,chunked:t,chunkRetry:3,chunkSize:a}),$("#uploader .success").die("click").live("click",function(){var e=$(this).find("span.title").attr("title");"explorer"==Config.pageApp?ui.path.list(core.pathFather(e),"tips",function(){ui.path.setSelectByFilename(core.pathThis(e))}):core.explorer(core.pathFather(e))}),$("#uploader .open").die("click").live("click",function(e){var t=$(this).find("span.title").attr("title");ui.pathOpen.open(t),stopPP(e)}),$(".upload_box_clear").die("click").live("click",function(){$("#thelist .item.success,#thelist .item.error").each(function(){$(this).slideUp(300,function(){$(this).remove()})})}),$("#uploader .remove").die("click").live("click",function(e){var t=$(this).parent().parent().attr("id");$(this).parent().parent().slideUp(function(){$(this).remove()}),uploader.skipFile(t),uploader.removeFile(t,!0),stopPP(e)});var i=0,n=0,o="0B/s",s=0,r=function(e,t){if(.3>=time_float()-s)return o;s=time_float();var a=e.size*t,i=5;e.speed===void 0?e.speed=[[time_float()-.5,0],[time_float(),a]]:i>=e.speed.length?e.speed.push([time_float(),a]):(e.speed=e.speed.slice(1,i),e.speed.push([time_float(),a]));var n=e.speed[e.speed.length-1],r=e.speed[0],l=(n[1]-r[1])/(n[0]-r[0]);return l=core.file_size(l)+"/s",o=l,l},l=[];uploader.on("fileQueued",function(t){if(!core.upload_check())return uploader.skipFile(t),uploader.removeFile(t),void 0;var a,n=$(e),a=t.fullPath;t.finished=!1,t.upload_to=urlDecode(G.this_path),(void 0==a||"undefined"==a)&&(a=t.name),i++,$(e).find(".item").length>0&&(n=$(e).find(".item:eq(0)"));var o='<div id="'+t.id+'" class="item"><div class="info">'+'<span class="title" title="'+G.this_path+a+'">'+core.pathThis(a)+"</span>"+'<span class="size">'+core.file_size(t.size)+"</span>"+'<span class="state">'+LNG.upload_ready+"</span>"+'<a class="remove font-icon icon-remove" href="javascript:void(0)"></a>'+'<div style="clear:both"></div></div></div>';$(e).find(".item").length>0?$(o).insertBefore($(e).find(".item:eq(0)")):$(e).append(o),uploader.upload()}).on("uploadBeforeSend",function(e,t){var a=urlEncode(e.file.fullPath);(void 0==a||"undefined"==a)&&(a=""),t.fullPath=a,t.upload_to=e.file.upload_to}).on("uploadProgress",function(e,t){$(".dialog_file_upload .aui_title").text(LNG.uploading+": "+n+"/"+i+" ("+o+")");var a=r(e,t),s=$("#"+e.id),l=s.find(".progress .progress-bar");l.length||(l=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(s).find(".progress-bar")),s.find(".state").text(parseInt(100*t)+"%("+a+")"),l.css("width",100*t+"%")}).on("uploadAccept",function(e,t){e.file.serverData=t;try{l.push(core.pathThis(t.info))}catch(a){}}).on("uploadSuccess",function(e){var t=36*$("#"+e.id).index(".item");$("#uploader").scrollTop(t),n++;var a=e.serverData;if(a.code?($("#"+e.id).addClass("success"),$("#"+e.id).find(".state").text(a.data),$("#"+e.id).find(".remove").removeClass("icon-remove").addClass("icon-ok").addClass("open").removeClass("remove")):($("#"+e.id).addClass("error").find(".state").addClass("error"),$("#"+e.id).find(".state").text(a.data).attr("title",a.data)),uploader.removeFile(e),$("#"+e.id).find(".progress").fadeOut(),!e.fullPath){var i=l;ui.f5_callback(function(){ui.path.setSelectByFilename(i)})}}).on("uploadError",function(e,t){n++,$("#"+e.id).find(".progress").fadeOut(),$("#"+e.id).addClass("error").find(".state").addClass("error"),$("#"+e.id).find(".state").text(LNG.upload_error+"("+t+")")}).on("uploadFinished",function(){$(".dialog_file_upload .aui_title").text(LNG.upload_success+": "+n+"/"+i),i=0,n=0,uploader.reset();var e=l;if(ui.f5_callback(function(){ui.path.setSelectByFilename(e),l=[]}),"explorer"==Config.pageApp){if("share"==G.share_page)return;ui.tree.checkIfChange(G.this_path)}}).on("error",function(e){core.tips.tips(e,!1)});var c;inState=!1,dragOver=function(){0==inState&&(inState=!0,MaskView.tips(LNG.upload_drag_tips)),c&&window.clearTimeout(c)},dragLeave=function(e){stopPP(e),c&&window.clearTimeout(c),c=window.setTimeout(function(){inState=!1,MaskView.close()},100)},dragDrop=function(e){try{if(e=e.originalEvent||e,core.upload_check()){var t=e.dataTransfer.getData("text/plain");t&&"http"==t.substring(0,4)?ui.pathOperate.appAddURL(t):core.upload()}stopPP(e)}catch(e){}inState&&(inState=!1,MaskView.close())}}}}),define("app/tpl/copyright.html",[],'<div class="copyright_dialog_content">\n	<div class="title">\n		<div class="logo"><i class="icon-cloud"></i>KodExplorer v{{G.version}}</div>\n		<div class=\'info\'>——{{LNG.kod_name_copyright}}</div>\n	</div>\n	<div class="content">\n		<p>{{#LNG.copyright_desc}}</p>\n		<div>{{#LNG.copyright_contact}}</div>\n		<div>{{#LNG.copyright_info}}</div> \n	</div>\n</div>'),define("app/tpl/search.html",[],"<div class='do_search'>\n    <div class='search_header'>\n       <div class='s_br'>\n            <input type='text' id='search_value' value='{{param.search}}'/><a class='right button icon-search'></a>\n            <div style='float:right'>{{LNG.path}}:<input type='text' id='search_path' value='{{param.path}}'/></div>\n        </div>\n       <div class='s_br'>\n            <input type='checkbox' id='search_is_case' {{if param.is_case}}checked='true'{{/if}}/>\n            <label for='search_is_case'>{{LNG.search_uplow}}</label>\n            <input type='checkbox' id='search_is_content' {{if param.is_content}}checked='true'{{/if}}/>\n            <label for='search_is_content'>{{LNG.search_content}}</label>\n            <div style='float:right'>{{LNG.file_type}}:<input type='text' id='search_ext' value='{{param.ext}}' title='{{LNG.search_ext_tips}}'/></div>\n        </div>\n    </div>\n    <div class='search_result'>\n        <table border='0' cellspacing='0' cellpadding='0'>\n            <tr class='search_title'>\n               <td class='name'>{{LNG.name}}</td>\n               <td class='type'>{{LNG.type}}</td>\n               <td class='size'>{{LNG.size}}</td>\n               <td class='path'>{{LNG.path}}</td>\n            </tr>\n            <tr class='message'><td colspan='4'></td></tr>\n        </table>\n    </div>\n</div>\n\n"),define("app/tpl/search_list.html",[],"{{each folderlist as v i}}\n    <tr class='list folder' data-path='{{v.path}}' data-type='folder' data-size='0'>\n        <td class='name'><a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a></td>\n        <td class='type'>{{LNG.folder}}</td>\n        <td class='size'>0</td>\n        <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>\n    </tr>\n{{/each}}\n{{each filelist as v i}}\n<tr class='list file'\n    data-path='{{v.path}}' \n    data-type='{{v.ext}}' \n    data-size='{{v.size}}'>\n    <td class='name' data-line=\"{{if v.search_line}}{{v.search_line}}{{/if}}\">\n        <a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a> \n        {{if v.search_line}}<span>&nbsp;({{v.search_line}})</span>{{/if}}\n    </td>\n    <td class='type'>{{v.ext}}</td>\n    <td class='size'>{{v.size}}</td>\n    <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>\n</tr>\n{{/each}}"),define("app/tpl/upload.html",[],"<div class='file_upload'>\n    <div class='top_nav'>\n       <a href='javascript:void(0);' class='menu this tab_upload'>{{LNG.upload_local}}</a>\n       <a href='javascript:void(0);' class='menu tab_download''>{{LNG.download_from_server}}</a>\n       <div style='clear:both'></div>\n    </div>\n    <div class='upload_box'>\n        <div class='btns'>\n            <div id='picker'>{{LNG.upload_select}}</div>\n            <div class=\"upload_box_tips\">\n            <a href=\"javascript:void(0);\" class=\"upload_box_clear\">{{LNG.upload_clear}}</a> \n            </div>\n            <div style='clear:both'></div>\n        </div>\n        <div id='uploader' class='wu-example'>\n            <div id='thelist' class='uploader-list'></div>\n        </div>\n    </div>\n    <div class='download_box hidden'>\n        <div class='list'>{{LNG.download_address}}<input type='text' name='url'/>\n\n        <div class=\"download_btn_group btn-group\">\n          <button class='btn btn-default btn-sm download_start' type='button'>{{LNG.download}}</button>\n          <button type=\"button\" class=\"btn btn-default btn-sm dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n            <span class=\"caret\"></span>&nbsp;\n            <span class=\"sr-only\">Dropdown</span>\n          </button>\n          <ul class=\"dropdown-menu\">\n            <li><a href=\"javascript:void(0);\" class=\"download_start_all\">批量添加</a></li>\n          </ul>\n        </div>\n\n        </div>\n        <div style='clear:both'></div>\n        <div id='downloader'>\n            <div id='download_list' class='uploader-list'></div>\n        </div>\n    </div>\n</div>"),define("app/src/setting/fav",[],function(){var e="index.php?fav/",t=function(t){$.ajax({url:e+"get",dataType:"json",async:!1,success:function(e){return e.code?(a(e.data,t),void 0):(tips(e),void 0)},error:function(){return!1}})},a=function(e,t){var a="<tr class='title'><td class='name'>"+LNG.name+"<span>("+LNG.can_not_repeat+")</span></td>"+"<td class='path'>"+LNG.address+"<span>("+LNG.absolute_path+")</span></td>"+"<td class='action'>"+LNG.action+"</td>"+"</tr>";for(var i in e)a+="<tr class='favlist' name='"+e[i].name+"' path='"+e[i].path+"'>"+"   <td class='name'><input type='text' id='sname' value='"+e[i].name+"' /></td>"+"   <td class='path'><input type='text' id='spath' value='"+e[i].path+"' /></td>"+"   <td class='action'>"+"       <a href='javascript:void(0)' onclick='' class='button edit'>"+LNG.button_save_edit+"</a>"+"       <a href='javascript:void(0)' onclick='' class='button del'>"+LNG.button_del+"</a>"+"   </td>"+"</tr>";if($("table#list").html(a),t&&"fav&"==t.substring(0,4)){var n=t.split("&")[1].split("=")[1],o=t.split("&")[2].split("=")[1],s=t.split("&")[3].split("=")[1],r="<tr class='favlist' name='' path=''>   <input type='hidden' id='stype' value='"+s+"' />"+"   <td class='name'><input type='text' id='sname' value='"+urlDecode(n)+"' /></td>"+"   <td class='path'><input type='text' id='spath' value='"+urlDecode(o)+"' /></td>"+"   <td class='action'>"+"       <a href='javascript:void(0)' class='button addsave'>"+LNG.button_save+"</a>"+"       <a href='javascript:void(0)' class='button addexit'>"+LNG.button_cancel+"</a>"+"   </td>"+"</tr>";$(r).insertAfter("table#list tr:last")}},i=function(){var e="<tr class='favlist' name='' path=''>   <input type='hidden' id='stype' value='folder' />   <td class='name'><input type='text' id='sname' value='' /></td>   <td class='path'><input type='text' id='spath' value='' /></td>   <td class='action'>       <a href='javascript:void(0)' class='button addsave'>"+LNG.button_save+"</a>"+"       <a href='javascript:void(0)' class='button addexit'>"+LNG.button_cancel+"</a>"+"   </td>"+"</tr>";$(e).insertAfter("table#list tr:last")},n=function(){var e=$(this).parent().parent();$(e).detach()},o=function(){var t=$(this).parent().parent(),a=$(t).find("#sname").val(),i=$(t).find("#spath").val(),n=$(t).find("#stype").val();return""==a||""==i?(tips(LNG.not_null,"error"),!1):($.ajax({url:e+"add&name="+urlEncode(a)+"&path="+urlEncode(i)+"&type="+n,dataType:"json",success:function(e){if(tips(e),e.code){$(t).attr("name",a),$(t).attr("path",i);var n="<a href='javascript:void(0)' class='button edit'>"+LNG.button_save_edit+"</a>&nbsp;"+"<a href='javascript:void(0)' class='button del'>"+LNG.button_del+"</a>";
$(t).find("td.action").html(n),FrameCall.father("ui.tree.refresh_fav",'""')}}}),void 0)},s=function(){var a=$(this).parent().parent(),i=$(a).attr("name"),n=$(a).find("#sname").val(),o=$(a).find("#spath").val();return""==n||""==o?(tips(LNG.not_null,"error"),!1):($.ajax({dataType:"json",url:e+"edit&name="+urlEncode(i)+"&name_to="+urlEncode(n)+"&path_to="+urlEncode(o),success:function(e){tips(e),e.code&&($(a).attr("name",n),FrameCall.father("ui.tree.refresh_fav",'""'),t())}}),void 0)},r=function(){var t=$(this).parent().parent(),a=$(t).attr("name");$.ajax({url:e+"del&name="+urlEncode(a),dataType:"json",async:!1,success:function(e){tips(e),e.code&&($(t).detach(),FrameCall.father("ui.tree.refresh_fav",'""'))}})},l=function(){$(".fav a.add").live("click",i),$(".fav a.addexit").live("click",n),$(".fav a.addsave").live("click",o),$(".fav a.edit").live("click",s),$(".fav a.del").live("click",r)};return l(),{init:t}}),define("app/src/setting/setting",[],function(){var e,t=function(e){core.setSkin(e),FrameCall.father("ui.setTheme",'"'+e+'"')},a=function(e){core.setSkin(e)},i=function(t){(""==t||void 0==t)&&(t="user"),e=t,"fav&"==t.substring(0,4)&&(t="fav"),$(".selected").removeClass("selected"),$("ul.setting a#"+t).addClass("selected"),window.location.href="#"+t,$.ajax({url:"./index.php?setting/slider&slider="+t,beforeSend:function(){$(".main").html("<img src='./static/images/loading.gif'/>")},success:function(a){var i="<div class='h1'>"+$(".menu_left .selected").html()+"</div>";$(".main").html(i+a),$(".main").fadeIn("fast"),"fav"==t&&Fav.init(e),"member"==t&&System.init(),e=t,$("a,img").attr("draggable","false")}})},n=function(){1!=G.is_root&&$("ul.setting #system").remove(),G.is_root||1==AUTH["system_member:get"]||1==AUTH["system_group:get"]?$("ul.setting #member").show():$("ul.setting #member").hide(),e=location.hash.split("#",2)[1],i(e),$("ul.setting a").click(function(){e!=$(this).attr("id")&&(e=$(this).attr("id"),i(e))}),$("#password_new").keyEnter(function(){Setting.tools()}),$(".setting_basic_save").live("click",function(){var e={};$(".system_setting .box_line input").each(function(){var t=$(this);if("checkbox"==t.attr("type")){var a=void 0==t.attr("checked")?"0":"1";e[t.attr("name")]=a}else"radius"!=t.attr("type")&&(e[t.attr("name")]=urlEncode(t.val()))}),e.first_in=$("input[name='first_in'][checked]").val(),o("recycle_open","1"),o("file_repeat","rename")}),$(".file_repeat_check label").live("click",function(){var e=$(this).find("input").val();o("file_repeat",e)}),$(".recycle_open_check input").live("click",function(){var e=void 0==$(this).attr("checked")?"0":"1";o("recycle_open",e)}),$(".box .list").live("hover",function(){$(this).addClass("listhover")},function(){$(this).toggleClass("listhover")}).live("click",function(){var e=$(this),a=e.parent();switch(type=a.attr("data-type"),value=e.attr("data-value"),a.find(".this").removeClass("this"),e.addClass("this"),type){case"wall":var i=G.static_path+"images/wall_page/"+value+".jpg";FrameCall.father("ui.setWall",'"'+i+'"');break;case"theme":t(value);break;case"musictheme":FrameCall.father("CMPlayer.changeTheme",'"music","'+value+'"');break;case"movietheme":FrameCall.father("CMPlayer.changeTheme",'"movie","'+value+'"');break;default:}o(type,value)}),$(".nav a").live("click",function(){$(".nav a").removeClass("this"),$(this).addClass("this");var e=$(this).attr("data-page");$(this).parent().parent().find(".section").addClass("hidden"),$(this).parent().parent().find("."+e).removeClass("hidden")})},o=function(e,t){var a="index.php?setting/set&k="+e+"&v="+t;$.ajax({url:a,dataType:"json",success:function(e){e.code?tips(e):core.authCheck("setting:set")?tips(LNG.config_save_error_file,!1):tips(LNG.config_save_error_auth,!1)}})},s=function(){var e=$(".selected").attr("id");switch(e){case"user":var t=urlEncode($("#password_now").val()),a=urlEncode($("#password_new").val());if(""==a||""==t){tips(LNG.password_not_null,"error");break}$.ajax({url:"index.php?user/changePassword&password_now="+t+"&password_new="+a,dataType:"json",success:function(e){if(tips(e),e.code){var t=share.system_top();t.location.href="./index.php?user/logout"}}});break;case"wall":var i=$("#wall_url").val();if(""==i){tips(LNG.picture_can_not_null,"error");break}FrameCall.father("ui.setWall",'"'+i+'"'),$(".box").find(".this").removeClass("this");var n="index.php?setting/set&k=wall&v="+urlEncode(i);$.ajax({url:n,dataType:"json",success:function(e){tips(e)}});default:}};return n(),{setGoto:i,tools:s,setThemeSelf:a,setTheme:t}}),define("app/src/setting/system/system_setting",[],function(){var e=function(){$("input[name='first_in']").live("click",function(){$("input[name='first_in']").removeAttr("checked"),$(this).attr("checked","checked")}),$(".system_save").live("click",function(){var e={};$(".system_setting .box_line input").each(function(){var t=$(this);if("checkbox"==t.attr("type")){var a=void 0==t.attr("checked")?"0":"1";e[t.attr("name")]=a}else"radius"!=t.attr("type")&&(e[t.attr("name")]=urlEncode(t.val()))}),e.first_in=$("input[name='first_in'][checked]").val(),a(e)}),t(),$(".phpinfo").die("click").live("click",function(){art.dialog.open("./index.php?setting/php_info",{title:"php_info",width:"70%",height:"65%",resize:!0})})},t=function(){$('.setting_menu .menu_list input[name="target"]').live("click",function(){"_blank"==$(this).val()?($(this).val("_self"),$(this).removeAttr("checked")):($(this).val("_blank"),$(this).attr("checked","checked"))}),$(".system_menu_add").live("click",function(){var e=$(".menu_default").clone().removeClass("menu_default hidden").addClass("menu_list");e.insertAfter(".setting_menu .menu_list:last")}),$(".setting_menu .menu_list .move_up").live("click",function(){var e=$(this).parent().parent();e.prev().hasClass("menu_list")&&e.insertBefore(e.prev())}),$(".setting_menu .menu_list .move_down").live("click",function(){var e=$(this).parent().parent();e.next().hasClass("menu_list")&&e.insertAfter(e.next())}),$(".setting_menu .menu_list .move_hidden").live("click",function(){var e=$(this).parent().parent();e.hasClass("menu_hidden")?(e.removeClass("menu_hidden"),$(this).text(LNG.menu_hidden)):(e.addClass("menu_hidden"),$(this).text(LNG.menu_show))}),$(".setting_menu .menu_list .move_del").live("click",function(){var e=$(this).parent().parent();e.remove()}),$(".system_menu_save").live("click",function(){var e=[];$(".setting_menu .menu_list").each(function(){var t=$(this),a={};t.hasClass("menu_default")||(t.find("input").each(function(){a[$(this).attr("name")]=urlEncode($(this).attr("value"))}),""!=a.name&&(a.use="1",a.type="",t.hasClass("menu_hidden")&&(a.use="0"),t.hasClass("menu_system")&&(a.type="system"),e.push(a)))}),a({menu:e})})},a=function(e){$.ajax({url:"index.php?setting/system_setting",type:"POST",data:"data="+urlEncode(json_encode(e)),dataType:"json",success:function(e){tips(e)}})};e()}),define("app/src/setting/system/system",["lib/contextMenu/jquery-contextMenu","lib/ztree/js/ztree","./system_member.js","./system_group.js","./system_role.js"],function(e){e("lib/contextMenu/jquery-contextMenu"),e("lib/ztree/js/ztree");var t=e("./system_member"),a=e("./system_group"),i=e("./system_role"),n=function(){o("system_group"),s(),i.init(),a.init()},o=function(e){$(".system_conennt .this").removeClass("this"),$(".system_conennt #"+e).addClass("this"),$(".left_content").addClass("hidden"),$("."+e).removeClass("hidden"),$(".right_frame").addClass("hidden"),$("#content_"+e).removeClass("hidden")},s=function(){$(".left_header .tab").die("click").live("click",function(){var e=$(this).attr("id");o(e)}),$(".title_tooltip").tooltip({placement:"bottom",html:!0})},r=function(e){e.each(function(){var e=core.user_space_html($(this).html());$(this).html(e)})},l=function(e){var t=G.basic_path+"data/User/"+e.path+"/home";e.group_id&&(t=G.basic_path+"data/Group/"+e.path+"/home"),window.parent&&window.parent.Config&&"explorer"==window.parent.Config.pageApp?(window.parent.ui.path.list(t),Tips.tips(LNG.system_open_true_path,!0)):core.explorer(t)};return{init:n,size_use:r,open_path:l,system_member:t,system_group:a,system_role:i}}),define("app/src/setting/system/system_member",[],function(e){var t,a,i=function(e){return void 0!=t?(n(e),void 0):($.ajax({url:"./index.php?system_member/get",dataType:"json",success:function(a){return a.code?(t=a.data,n(e),void 0):(tips(a),void 0)},error:function(){return!1}}),void 0)},n=function(i){""==i&&(i=a),a=i;var n=e("./tpl/user_list.html"),o=template.compile(n),s=o({LNG:LNG,select_group:i,user_list:t,group_list:System.system_group.get_group_list(),role_list:System.system_role.get_list()});$(".user_liser_content").html(s),$(".button_aciton_muti button").addClass("disabled"),System.size_use($("#content_system_group .user_list_cell .space"))},o=function(e,n,o){if(void 0!=n){"object"!=typeof n&&(n=[n]);var s={del:LNG.system_member_remove_tips,status_set:"",role_set:LNG.system_member_set_role,group_reset:"",group_remove_from:LNG.system_member_remove_group,group_add:""},r=function(){$.ajax({url:"./index.php?system_member/do_action&action="+e,type:"POST",data:"user_id="+json_encode(n)+"&param="+o,dataType:"json",beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(e){core.tips.close(e),artDialog.list.share_dialog&&artDialog.list.share_dialog.close(),t=void 0,i(a)}})};""==s[e]?r():$.dialog({id:"dialog_user_confirm",fixed:!0,icon:"question",padding:30,width:250,lock:!0,background:"#000",opacity:.2,content:s[e],ok:function(){r()},cancel:!0})}},s=function(e){var t={1:"read"};t[e]="read";var a={user_id:"",name:"",password:"123456",role:"default",group_info:t,config:{size_max:"1.5",size_use:"0"}};d(a,!0)},r=function(e){var t={1:"read"};t[e]="read";var a={user_id:"",name:"",password:"123456",role:"default",group_info:t,config:{size_max:"1.5",size_use:"0"}};d(a)},l=function(){var e=1073741824*parseFloat($(".size_max_set input").val()),t=core.file_size(e);0==e||isNaN(e)?$(".size_max_set i").html(LNG.space_tips_default):$(".size_max_set i").html(t)},c=function(){var e=System.system_group.get_group_list(),t=json_decode($("#group_info").attr("value")),a="";for(var i in t)a+="read"==t[i]?'<span class="label label-info" title="'+LNG.system_role_read+'">'+e[i].name+"</span>":'<span class="label label-primary" title="'+LNG.system_role_write+'">'+e[i].name+"</span>";$(".dlg_group_display .cell").html(a+'<div style="clear:both"></div>')},d=function(n,s){var r=System.system_role.get_list(),d=e("./tpl/user.html");s&&(d=e("./tpl/user_import.html"));var u=template.compile(d),f=u({LNG:LNG,user_info:n,role_list:r}),h=$.dialog({id:"share_dialog",simple:!0,resize:!1,width:425,background:"#000",opacity:.1,title:"",padding:"0",fixed:!0,lock:!0,content:f});l(),System.size_use($(".share_view_info")),$("#group_info").val(json_encode(n.group_info)),$(".dlg_group_select").unbind("click").bind("click",function(){p($("#group_info").val(),function(e){$("#group_info").val(e),c()})}),c(),$(".input_line #name").textFocus();var m="./index.php?system_member/add";if(s)m="./index.php?system_member/add&is_import=1";else if(""==n.name)$(".share_action .remove_button").hide();else var m="./index.php?system_member/edit&user_id="+n.user_id;$("#system_save").unbind("click").bind("click",function(){_()}),$(".select_drop_menu a").unbind("click").bind("click",function(){$(this).parent().parent().find("a").removeClass("selected"),$(this).addClass("selected"),$(".select_drop_menu .role_title").html($(this).html()),$("#role").val($(this).attr("data-role-id"))}),$(".remove_button").unbind("click").bind("click",function(){o("del",n.user_id,"")}),$(".dlg_goto_path").unbind("click").bind("click",function(){System.open_path(n)}),$(".content_box input").keyEnter(function(){_(!0)}),$("#system_save_goon_add").unbind("click").bind("click",function(){_(!0)});var _=function(e){s&&(e=!1);var o={};$(".share_dialog .content_info [name]").each(function(){var e=urlEncode($(this).val());""!=e&&(o[$(this).attr("name")]=e)}),$.ajax({url:m,data:o,type:"POST",dataType:"json",beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(o){return core.tips.close(o),o.code?(t=void 0,i(a),s?h.close():""!=n.name||1!=e?h.close():$(".input_line #name").val("").textFocus(),void 0):(s&&$("#name").val(o.info),void 0)}})}},p=function(t,a){var i=System.system_group.get_group_tree(),n=System.system_group.get_group_list();t=json_decode(t),$.isArray(t)&&(t={});var o={view:{showLine:!1,selectedMulti:!1,dblClickExpand:!1,addDiyDom:function(e,t){var a=15,i=$("#"+e+" #"+t.tId+"_switch"),n=$("#"+e+" #"+t.tId+"_ico");if(n.before(i).after('<i class="font-icon group_select_box icon-sort"></>').before('<span class="tree_icon button group"></span>').removeClass("ico_docu").addClass("group_icon").remove(),t.level>=1){var o="<span class='space' style='display:inline-block;width:"+a*t.level+"px'></span>";i.before(o)}$("#"+e+" #"+t.tId+"_a").attr("data-group-id",t.id)}},callback:{onClick:function(e,a,i){t||(t={}),$("#"+i.tId+"_a").hasClass("this")?delete t[i.id]:t[i.id]="read",l()}}},s=function(){var e=$("#user_group_select");$.fn.zTree.init(e,o,i);var t=$.fn.zTree.getZTreeObj("user_group_select");t.expandAll(!0)},r=function(){var i=e("./tpl/group_select.html"),n=template.compile(i),o=n({LNG:LNG});$.dialog({id:"select_usre_group_dlg",title:"设置分组",padding:"0",width:500,lock:!0,background:"#fff",opacity:.1,fixed:!0,content:o,ok:function(){a(json_encode(t))},cancel:!0}),s()},l=function(){var e="";$("#user_group_select .curSelectedNode").removeClass("curSelectedNode"),$("#user_group_select a[data-group-id").removeClass("this");var a=function(e){var t={read:LNG.system_role_read,write:LNG.system_role_write},a="",i='class="selected"',n="btn-primary";"read"==e&&(a='class="selected"',i="",n="btn-default");var o='<div class="btn-group select_drop_menu open">                  <button class="btn '+n+' btn-xs" type="button" data-toggle="dropdown">                    <span class="group_info_title pr-5">'+t[e]+'</span><span class="caret"></span>                  </button>                  <ul class="dropdown-menu" data-current="'+e+'">                    <li data-info="read" '+a+">"+LNG.system_role_read+'</li>                    <li data-info="write" '+i+">"+LNG.system_role_write+"</li>                  </ul>                </div>";return o};for(var i in t)$("#user_group_select a[data-group-id="+i+"]").addClass("this"),e+='<li class="group_self" group-id="'+i+'">'+'    <span class="title"><i class="font-icon icon-group"></i>'+n[i].name+"</span>"+'    <i class="font-icon icon-remove remove"></i>'+a(t[i])+"</li>";$(".select_group_right").html(e)},c=function(){$(".right_content .group_self .remove").die("click").live("click",function(){var e=$(this).parent().attr("group-id");delete t[e],l()}),$(".group_self .dropdown-menu li").die("click").live("click",function(){var e=$(this).attr("data-info"),a=$(this).parent().attr("data-current"),i=$(this).parent().parent().parent().attr("group-id");a!=e&&(t[i]=e,l())})};r(),l(),c()},u=function(){$(".context-menu-list").filter(":visible").trigger("contextmenu:hide")},f=function(){$("body").click(u).contextmenu(u),$.contextMenu({zIndex:9999,selector:".user_action_menu",items:{user_list_edit:{name:LNG.edit,icon:"edit",accesskey:"e"},sep1:"--------",user_remove:{name:LNG.remove,icon:"trash",accesskey:"d"},user_status_close:{name:LNG.system_member_unuse,icon:"",accesskey:"c"},user_status_open:{name:LNG.system_member_use,icon:"",accesskey:"o"},sep2:"--------",group_remove_from:{name:LNG.system_member_group_remove,icon:"",accesskey:"g"},group_add:{name:LNG.system_member_group_insert,icon:"",accesskey:"a"},group_reset:{name:LNG.system_member_group_reset,icon:"",accesskey:"i"}},callback:function(e,t){var a=t.$trigger.attr("data-id");$("#content_system_group .group_title").attr("data-id");var i=[a];m(e,i,"")}})},h=function(){$(".size_max_set input").live("input",l),$("#content_system_group .content [data-action]").live("click",function(e){if(!$(e.target).is("input")){var t=$(this),a=t.attr("data-action"),i=[];if($("#content_system_group .user_select:checked").each(function(){i.push($(this).parent().parent().attr("data-id"))}),"user_list_edit"==a){var n=t.parent().parent().attr("data-id");i=[n]}return m(a,i,t,e),!0}})},m=function(e,a,i,n){var l=$("#content_system_group .group_title").attr("data-id");switch(e){case"user_add":r(l);break;case"user_import":s(l);break;case"group_remove_from":o("group_remove_from",a,l);break;case"group_add":p("{}",function(e){o("group_add",a,e)});break;case"group_reset":p("{}",function(e){o("group_reset",a,e)});break;case"role_set":var c=i.attr("data-role-id");o("role_set",a,c);break;case"user_status_open":o("status_set",a,1);break;case"user_status_close":o("status_set",a,0);break;case"user_remove":o("del",a,"");break;case"user_list_select":var u=i.find(".user_select");u.attr("checked")?u.removeAttr("checked"):u.attr("checked","true"),_();break;case"user_list_edit":d(t[a[0]]),stopPP(n);break;default:}},_=function(){$("#content_system_group .user_select:checked").length>=1?$(".button_aciton_muti button").removeClass("disabled"):$(".button_aciton_muti button").addClass("disabled"),$("#content_system_group .user_list_cell ").removeClass("selected"),$("#content_system_group .user_select:checked").each(function(){$(this).parent().parent().addClass("selected")})},v=function(){$("#content_system_group .user_select_set").live("click",function(){$(this).attr("checked")?$("#content_system_group .user_select").attr("checked","true"):$("#content_system_group .user_select").removeAttr("checked"),_()}),$("#content_system_group .user_select").live("click",function(){_()})};return v(),h(),f(),{reset_list:function(){t=void 0},load_list:i,add:r}}),define("app/src/setting/system/tpl/user_list.html",[],'<div class="user_tool_bar">\n    <div class="btn-group btn-group-sm ml-10">\n      <button type="button" class="btn btn-default" data-action="user_add">{{LNG.system_member_add}}</button>\n      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n        <span class="caret"></span>&nbsp;\n        <span class="sr-only">Dropdown</span>\n      </button>\n      <ul class="dropdown-menu">\n        <li><a href="javascript:void(0);" data-action="user_import">{{LNG.system_member_import}}</a></li>\n      </ul>\n    </div>\n\n    <div class="btn-group btn-group-sm ml-10 button_aciton_muti">\n      <button class="btn btn-default btn-sm" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n        <span class="role_title pr-5">{{LNG.system_member_group_config}}</span><span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n            <li><a href="javascript:void(0);" data-action="group_remove_from">{{LNG.system_member_group_remove}}</a></li>\n            <li><a href="javascript:void(0);" data-action="group_add">{{LNG.system_member_group_insert}}</a></li>\n            <li class="divider disabled"></li>\n            <li><a href="javascript:void(0);" data-action="group_reset">{{LNG.system_member_group_reset}}</a></li>\n      </ul>\n    </div>\n    <div class="btn-group btn-group-sm ml-5 button_aciton_muti">\n      <button class="btn btn-default btn-sm" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n        <span class="role_title pr-5">{{LNG.system_member_role}}</span><span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu">\n            {{each role_list as value key}}\n            <li><a href="javascript:void(0);" data-action="role_set" data-role-id="{{key}}">{{value}}</a></li>\n            {{/each}}\n      </ul>\n    </div>\n\n    <div class="btn-group btn-group-sm button_aciton_muti ml-10">\n        <button class="btn btn-default" data-action="user_status_close">{{LNG.system_member_unuse}}</button>\n        <button class="btn btn-default" data-action="user_status_open">{{LNG.system_member_use}}</button>\n        <button class="btn btn-default" data-action="user_remove">{{LNG.remove}}</button>\n    </div>\n</div>\n<div class="user_list">\n    <table id="list" align="center" border="0" cellspacing="0" cellpadding="0">\n        <tbody>\n            <tr class="title">\n                <td class="select"><input type=\'checkbox\' class="user_select_set"/></td>\n                <td class="name">{{LNG.username}}</td>\n                <td class="role">{{LNG.system_member_role}}</td>\n                <td class="space">{{LNG.space_size_use}}</td>\n                <td class="group">{{LNG.system_member_group}}</td>\n            </tr>\n            {{each user_list as v i}}\n                {{if select_group==\'1\' || v.group_info[select_group]}}\n                <tr data-id="{{v.user_id}}" data-action="user_list_select" class="user_action_menu user_list_cell {{if v.status=="0"}}unuse{{/if}}">\n                    <td class="select">\n                        {{if v.user_id!=\'1\'}}<input type=\'checkbox\' class="user_select"/>{{/if}}\n                    </td>\n                    <td class="name"><a data-action="user_list_edit" href="javascript:void(0);">{{v.name}}</a></td>\n                    <td class="role">{{role_list[v.role]}}</td>\n                    <td class="space">{{v.config.size_use}}/{{v.config.size_max}}</td>\n                    <td class="group">\n                        {{each v.group_info as group_read group_id}}\n                            {{if group_read=="read"}}\n                            <span class="label label-info" title="{{LNG.system_role_read}}">{{group_list[group_id][\'name\']}}</span>\n                            {{else}}\n                            <span class="label label-primary" title="{{LNG.system_role_write}}">{{group_list[group_id][\'name\']}}</span>\n                            {{/if}}\n                        {{/each}}\n                    </td>\n                </tr>\n                {{/if}}\n            {{/each}}        \n        </tbody>\n    </table>\n</div><!-- 用户列表 -->\n\n\n'),define("app/src/setting/system/tpl/user.html",[],'<div class=\'content_box\'>\n    <div class=\'title\'>\n        <div class="titleinfo">\n	        {{if !user_info.name}}\n	        <i class="font-icon icon-group"></i>{{LNG.system_member_add}}\n	        {{else}}\n	        <i class="font-icon icon-pencil"></i>{{user_info.name}}	        \n	        {{/if}}\n        </div>    \n        {{if user_info.name}}\n		<div class="share_view_info">{{user_info.config.size_use}}/{{user_info.config.size_max}}</div>\n		{{/if}}    \n    </div>\n    <div class=\'content_info\'>\n    	<div class="input_line">\n			<span class="input_title">{{LNG.username}}:</span>\n			<input id="name" type="text" name="name" value="{{user_info.name}}" />\n			{{if user_info.name}}\n			<a href="javascript:void(0);" class="font-icon-label dlg_goto_path"><i class="font-icon icon-folder-open"></i></a>\n			{{else}}\n			<i class="desc">{{LNG.username}}</i>\n			{{/if}}\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line">\n			<span class="input_title">{{LNG.password}}:</span>\n			<input id="password" type="text" name="password" \n			value="{{if !user_info.name}}{{user_info.password}}{{/if}}" \n			placeholder="{{if user_info.name}}{{LNG.system_member_password_tips}}{{/if}}"/>\n			{{if user_info.name}}<i class="desc">{{LNG.system_member_password_tips}}</i>{{/if}}\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line size_max_set">\n			<span class="input_title">{{LNG.space_size}}:</span>\n			<input id="size_max" type="text" name="size_max" value="{{user_info.config.size_max}}" />\n			<i class="desc label label-default" style="color:#698ebf;background:#E9F3F9;"></i>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line">\n			<span class="input_title">{{LNG.system_member_role}}:</span>\n			<input type="hidden" id="role" name="role" value="{{user_info.role}}"/>\n			<div class="btn-group select_drop_menu">\n			  <button class="btn btn-default btn-xs" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n			    <span class="role_title pr-5">\n			    {{if role_list[user_info.role]}}\n			    {{role_list[user_info.role]}}\n			    {{else}}\n			    <i>{{LNG.system_member_role_select}}</i>\n			    {{/if}}\n			    </span><span class="caret"></span>\n			  </button>\n			  <ul class="dropdown-menu">\n			    {{each role_list as value key}}\n                    {{if key==user_info.role}}\n                    <li><a href="javascript:void(0);" class="selected" data-role-id="{{key}}">{{value}}</a></li>\n                    {{else}}\n                    <li><a href="javascript:void(0);" data-role-id="{{key}}">{{value}}</a></li>\n                    {{/if}}\n                {{/each}}\n			  </ul>\n			</div>\n\n			<!-- <input type="text" id="role" name="role" value="{{user_info.role}}" /> -->\n			<i class="desc">{{LNG.system_member_role}}</i>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line">\n			<span class="input_title">{{LNG.system_member_group}}:</span>\n			<input id="group_info" type="hidden" name="group_info" value="{{user_info.group_info}}" />\n\n			<div class="dlg_group_display">\n				<div class="cell"></div>\n				<button class="btn btn-default btn-sm dlg_group_select" type="button">\n				    <i class="font-icon icon-pencil"></i><span class="group_title pl-10">{{LNG.system_member_group_edit}}</span>\n				</button>\n			</div>\n			<div style="clear:both"></div>\n		</div>\n	</div>\n\n	<div class="share_action">\n		{{if !user_info.name}}\n		<button type="button" class="btn btn-primary" id="system_save">{{LNG.button_add}}</button>\n		<button type="button" class="btn btn-primary" id="system_save_goon_add">{{LNG.button_save_and_add}}</button>\n		{{else}}\n		<button type="button" class="btn btn-primary" id="system_save">{{LNG.button_save}}</button>\n		<a type="button" href="javascript:void(0);" class="remove_button">{{LNG.button_del}}</a>\n		{{/if}}\n	</div>\n</div>'),define("app/src/setting/system/tpl/user_import.html",[],'<style>\n	textarea#name{width:157px;height:100px;border:1px solid #ddd;font-size:13px;\n		border-radius: 3px;outline:none;}\n	textarea#name:focus{border-color: #75a1f0;box-shadow: 0 0 4px #75a1f0;}\n</style>\n<div class=\'content_box\'>\n    <div class=\'title\'>\n        <div class="titleinfo">\n	        <i class="font-icon icon-group"></i>{{LNG.system_member_import}}\n        </div>  \n    </div>\n    <div class=\'content_info\'>\n		<div class="input_line">\n			<span class="input_title">{{LNG.username}}:</span>\n			<textarea id="name" type="text" name="name" value="{{user_info.name}}"></textarea>\n			<i class="desc" style="display:inline-block;width:130px;line-height:20px;">{{#LNG.system_member_import_desc}}</i>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line">\n			<span class="input_title">{{LNG.password}}:</span>\n			<input id="password" type="text" name="password" value="{{user_info.password}}"/>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line size_max_set">\n			<span class="input_title">{{LNG.space_size}}:</span>\n			<input id="size_max" type="text" name="size_max" value="{{user_info.config.size_max}}" />\n			<i class="desc label label-default" style="color:#698ebf;background:#E9F3F9;"></i>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line">\n			<span class="input_title">{{LNG.system_member_role}}:</span>\n			<input type="hidden" id="role" name="role" value="{{user_info.role}}"/>\n			<div class="btn-group select_drop_menu">\n			  <button class="btn btn-default btn-xs" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n			    <span class="role_title pr-5">\n			    {{if role_list[user_info.role]}}\n			    {{role_list[user_info.role]}}\n			    {{else}}\n			    <i>{{LNG.system_member_role_select}}</i>\n			    {{/if}}\n			    </span><span class="caret"></span>\n			  </button>\n			  <ul class="dropdown-menu">\n			    {{each role_list as value key}}\n                    {{if key==user_info.role}}\n                    <li><a href="javascript:void(0);" class="selected" data-role-id="{{key}}">{{value}}</a></li>\n                    {{else}}\n                    <li><a href="javascript:void(0);" data-role-id="{{key}}">{{value}}</a></li>\n                    {{/if}}\n                {{/each}}\n			  </ul>\n			</div>\n\n			<!-- <input type="text" id="role" name="role" value="{{user_info.role}}" /> -->\n			<i class="desc">{{LNG.system_member_role}}</i>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line">\n			<span class="input_title">{{LNG.system_member_group}}:</span>\n			<input id="group_info" type="hidden" name="group_info" value="{{user_info.group_info}}" />\n\n			<div class="dlg_group_display">\n				<div class="cell"></div>\n				<button class="btn btn-default btn-sm dlg_group_select" type="button">\n				    <i class="font-icon icon-pencil"></i><span class="group_title pl-10">{{LNG.system_member_group_edit}}</span>\n				</button>\n			</div>\n			<div style="clear:both"></div>\n		</div>\n	</div>\n\n	<div class="share_action">\n		<button type="button" class="btn btn-primary" id="system_save">{{LNG.button_add}}</button>\n	</div>\n</div>'),define("app/src/setting/system/tpl/group_select.html",[],'<div class=\'content_box select_user_group\'>\n    <div class=\'content_info\'>\n    	<div class="title_info">\n    		<span class="title">{{LNG.system_group_select}}:</span>\n    		<span class="title title_right">{{LNG.system_group_select_result}}:</span>\n    	</div>\n    	<div class="left_content ztree" id=\'user_group_select\'></div>\n    	<div class="center_action"><i class="font-icon icon-arrow-right"></i></div>\n    	<div class="right_content">\n    		<ul class="select_group_right">\n			</ul>\n    	</div>\n    	<div style="clear:both"></div>\n	</div>\n</div>'),define("app/src/setting/system/system_group",[],function(e){var t,a,i,n,o=function(){d(),l(),$(".ztree .switch").die("mouseenter").live("mouseenter",function(){$(this).addClass("switch_hover")}).die("mouseleave").live("mouseleave",function(){$(this).removeClass("switch_hover")}),$(".menuGroup").die("mouseenter").live("mouseenter",function(){$(this).addClass("hover")}).die("mouseleave").live("mouseleave",function(){$(this).removeClass("hover")}),G.is_root||$("[data-action=group_home").addClass("hidden")},s={view:{showLine:!1,selectedMulti:!1,dblClickExpand:!0,addDiyDom:function(e,t){var a=18,i=$("#"+e+" #"+t.tId+"_switch"),n=$("#"+e+" #"+t.tId+"_ico");if(n.before(i).before('<span class="tree_icon button group"></span>').remove(),t.level>=1){var o="<span class='space' style='display: inline-block;width:"+a*t.level+"px'></span>";i.before(o)}$("#"+e+" #"+t.tId+"_a").addClass("menuGroup").append("<i class='sub_menu icon-reorder'><i>").attr("data-group-id",t.id)}},callback:{onClick:function(e,t,a){r(t,a.id)},beforeRightClick:function(e,t){r(e,t.id)}}},r=function(e,a){if("folderList"==e){n=a;var i=t.getNodeByParam("id",a,null);t.selectNode(i),v(a)}else"group_parent_select"==e&&($("#group_parent").val(a),$(".select_group").addClass("hidden"),h())},l=function(){$.ajax({url:"./index.php?&system_group/get",dataType:"json",error:function(){$("#folderList").html('<div style="text-align:center;">'+LNG.system_error+"</div>")},success:function(e){return e.code?(a=e.data,i=e.info,$.fn.zTree.init($("#folderList"),s,a),t=$.fn.zTree.getZTreeObj("folderList"),t.expandAll(!0),void 0==n&&(n="1"),r("folderList",n),0!=$("#group_parent_select").length&&m(),void 0):($("#folderList").html('<div style="text-align:center;">'+LNG.system_error+"</div>"),void 0)}})},c=function(){$(".context-menu-list").filter(":visible").trigger("contextmenu:hide")},d=function(){$("body").click(c).contextmenu(c),$.contextMenu({zIndex:9999,selector:".menuGroup",items:{add_child:{name:LNG.system_group_add,icon:"plus",accesskey:"u"},edit:{name:LNG.edit,icon:"edit",accesskey:"e"},sep1:"--------",add_user:{name:LNG.system_member_add,icon:"user",accesskey:"g"},remove:{name:LNG.remove,icon:"remove-sign",accesskey:"r"}},callback:function(e,a){var i=a.$trigger.attr("id");
i=i.replace("_a","");var n=t.getNodeByTId(i);switch(e){case"add_user":System.system_member.add(n.id);break;case"add_child":var o=p();o.parent_id=n.id,_(o);break;case"edit":var o=p(n.id);_(o);break;case"remove":u(n.id);break;default:}}}),$(".sub_menu").die("click").live("click",function(e){$(this).contextMenu({x:e.pageX,y:e.pageY})})},p=function(e){return void 0==e?{group_id:"",name:"",parent_id:"",children:"",config:{size_max:"0",size_use:""},path:"",create_time:""}:i[e]},u=function(e,a){var i=t.getSelectedNodes()[0],n=i.getParentNode(),o="./index.php?system_group/del&group_id="+e;$.dialog({id:"dialog_path_remove",fixed:!0,icon:"question",title:LNG.system_group_remove,padding:40,width:200,lock:!0,background:"#000",opacity:.3,content:LNG.system_group_remove_tips,ok:function(){$.ajax({url:o,type:"POST",dataType:"json",beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(t){core.tips.close(t),System.system_member.reset_list(),r("folderList",n.id),l(),"function"==typeof a&&a(e)}})},cancel:!0})},f=function(){var e=1073741824*parseFloat($(".size_max_set input").val()),t=core.file_size(e);0==e||isNaN(e)?$(".size_max_set i").html(LNG.space_tips_default):$(".size_max_set i").html(t)},h=function(){var e=$("#group_parent_select"),t=$("#group_parent").val();if(e.find("a.menuGroup").removeClass("curSelectedNode"),""==t)return $(".select_parent_content .group_title").html("is root"),!1;var a=System.system_group.get_group_info(t);return $(".select_parent_content .group_title").html(a.name),e.find("a[data-group-id="+t+"]").addClass("curSelectedNode"),!0},m=function(){var e=$("#group_parent_select");$.fn.zTree.init(e,s,a);var t=$.fn.zTree.getZTreeObj("group_parent_select");t.expandAll(!0),h()&&$(".select_parent_content .btn").unbind("click").bind("click",function(){$(".select_group").toggleClass("hidden")})},_=function(t){var a=e("./tpl/group.html"),i=template.compile(a),n=i({LNG:LNG,group_info:t}),o=$.dialog({id:"share_dialog",simple:!0,resize:!1,width:425,background:"#000",opacity:.1,title:"",padding:"0",fixed:!0,lock:!0,content:n});f(),System.size_use($(".share_view_info")),m(),$(".input_line #name").textFocus();var s="./index.php?system_group/add";if(""!=t.name)var s="./index.php?system_group/edit&group_id="+t.group_id;$("#system_save").unbind("click").bind("click",function(){r()}),$(".dlg_goto_path").unbind("click").bind("click",function(){System.open_path(t)}),$(".remove_button").unbind("click").bind("click",function(){u(t.group_id,function(){o.close()})}),$(".content_box input").keyEnter(function(){r(!0)}),$("#system_save_goon_add").unbind("click").bind("click",function(){r(!0)});var r=function(e){var a="";$(".share_dialog .content_info input[name]").each(function(){var e=urlEncode($(this).val());""!=e&&(a+="&"+$(this).attr("name")+"="+e)}),$.ajax({url:s,data:a,type:"POST",dataType:"json",beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(a){core.tips.close(a),a.code&&(l(),""!=t.name||1!=e?o.close():setTimeout(function(){$(".input_line #name").val("").textFocus()},200))}})}},v=function(e){var t=p(e);$(".group_title .group_title_span").html(t.name),$(".group_title").attr("data-id",t.group_id),$(".group_size").html(t.config.size_use+"/"+t.config.size_max),System.size_use($(".group_size")),System.system_member.load_list(e)},g=function(){$(".size_max_set input").live("input",f),$("#content_system_group .header_content [data-action]").live("click",function(){var e=$(this).attr("data-action"),t=$("#content_system_group .group_title").attr("data-id"),a=p(t);switch(e){case"group_edit":_(a);break;case"group_home":System.open_path(a);break;case"group_add_child":var i=p();i.parent_id=t,_(i);break;default:}})};g();var b=function(){return i},y=function(){return a};return{init:o,get_group_tree:y,get_group_list:b,get_group_info:p}}),define("app/src/setting/system/tpl/group.html",[],'<div class=\'content_box\'>\n    <div class=\'title\'>\n        <div class="titleinfo">\n	        {{if !group_info.name}}\n	        <i class="font-icon icon-plus"></i>{{LNG.system_group_create}}\n	        {{else}}\n	        <i class="font-icon icon-pencil"></i>{{group_info.name}}\n	        {{/if}}\n		</div>\n		{{if group_info.name}}\n		<div class="share_view_info">{{group_info.config.size_use}}/{{group_info.config.size_max}}</div>\n		{{/if}}\n    </div>\n    <div class=\'content_info\'>\n    	<div class="input_line">\n			<span class="input_title">{{LNG.system_group_name}}:</span>\n			<input id="name" type="text" name="name" value="{{group_info.name}}" />\n			{{if group_info.name}}\n			<a href="javascript:void(0);" class="font-icon-label dlg_goto_path"><i class="font-icon icon-folder-open"></i></a>\n			{{else}}\n			<i class="desc">{{LNG.name}}</i>\n			{{/if}}\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line size_max_set">\n			<span class="input_title">{{LNG.space_size}}:</span>\n			<input id="size_max" type="text" name="size_max" value="{{group_info.config.size_max}}" />\n			<i class="desc label label-default" style="color:#698ebf;background:#E9F3F9;"></i>\n			<div style="clear:both"></div>\n		</div>\n		<div class="input_line select_parent_content">\n			<span class="input_title">{{LNG.system_group_father}}:</span>\n			<input id="group_parent" type="hidden" name="parent_id" value="{{group_info.parent_id}}" />\n			<button class="btn btn-default btn-sm" type="button">\n			    <i class="font-icon icon-group"></i><span class="group_title pl-10"></span>\n			</button>\n			<ul class="select_group hidden ztree" id="group_parent_select"></ul>\n			<div style="clear:both"></div>\n		</div>\n	</div>\n\n	<div class="share_action">		\n		{{if !group_info.name}}\n		<button type="button" class="btn btn-primary" id="system_save">{{LNG.button_add}}</button>\n		<button type="button" class="btn btn-primary" id="system_save_goon_add">{{LNG.button_save_and_add}}</button>\n		{{else}}\n		<button type="button" class="btn btn-primary" id="system_save">{{LNG.button_save}}</button>\n		<a type="button" href="javascript:void(0);" class="remove_button">{{LNG.button_del}}</a>\n		{{/if}}\n	</div>\n</div>\n\n'),define("app/src/setting/system/system_role",[],function(){var e,t,a=function(){$.ajax({url:"index.php?system_role/get",dataType:"json",async:!1,success:function(a){return a.code?(e=a.data,i(),void 0==t&&(t="1"),n(t),void 0):(tips(a),void 0)}}),$(".group_editor .path_ext_tips").tooltip({placement:"bottom",html:!0}),$(".group_editor .warning").tooltip({placement:"bottom",html:!0})},i=function(){var t="";$.each(e,function(e,a){t+='<li class="role_cell" data-role-id="'+e+'">'+"<span>"+a.name+'</span><i class="sub_menu icon-angle-right"></i></li>'}),$(".role_list_cell").html(t)},n=function(a){var i;t=a,$(".system_role li.role_cell").removeClass("select"),$("#content_system_role [data-action=role_add],#content_system_role [data-action=role_delete]").show(),void 0==a?(i={name:"",ext_not_allow:"php|jsp|html"},$("#content_system_role [data-action=role_add],#content_system_role [data-action=role_delete]").hide(),$("#content_system_role .role_title").html(LNG.system_role_add)):(i=e[a],$(".system_role [data-role-id="+a+"]").addClass("select"),$("#content_system_role .role_title").html(i.name)),$(".group_editor #name").val(i.name).textFocus(),$(".group_editor #ext_not_allow").val(i.ext_not_allow),$(".group_editor .tag").removeClass("this"),$(".group_editor input").removeAttr("checked"),$(".group_editor .tag").each(function(){var e=$(this),t=e.attr("data-role");t=t.split(";"),t=t[0],i[t]&&(e.addClass("this"),e.find("input").attr("checked",!0))})},o=function(){var e=$(".group_editor #name").val(),i=$(".group_editor #ext_not_allow").val(),n={},o="index.php?system_role/add";return void 0==i&&(i=""),""==e?(tips(LNG.not_null,"error"),!1):($(".group_editor .tag.this").each(function(){for(var e=$(this).attr("data-role").split(";"),t=0;e.length>t;t++)n[e[t]]=1}),"1"==t&&n!={}&&(n={},tips(LNG.system_role_admin_set,"warning")),void 0!=t&&(o="index.php?system_role/edit&role_id="+t),$.ajax({url:o+"&name="+urlEncode(e)+"&ext_not_allow="+i,data:n,type:"POST",dataType:"json",success:function(e){tips(e),e.code&&(t=e.info,a(),System.system_member.load_list(""))}}),void 0)},s=function(e){$.dialog({fixed:!0,icon:"question",drag:!0,title:LNG.warning,content:LNG.if_remove+c(e)+"?<br/>"+LNG.group_remove_tips,cancel:!0,ok:function(){$.ajax({url:"index.php?system_role/del&role_id="+e,async:!1,dataType:"json",success:function(e){tips(e),e.code&&(t=void 0,a(),System.system_member.reset_list(),System.system_member.load_list(""))}})}})},r=function(){$(".group_editor .tag").each(function(){$(this).hasClass("this")?($(this).removeClass("this"),$(this).find("input").removeAttr("checked")):($(this).addClass("this"),$(this).find("input").attr("checked",!0)),$(".group_editor .combox:eq(0) .tag:eq(0)").hasClass("this")||($(".group_editor .combox:eq(0) .tag").removeClass("this"),$(".group_editor .combox:eq(0) .tag").find("input").removeAttr("checked")),$(".group_editor .combox:eq(1) .tag:eq(0)").hasClass("this")||($(".group_editor .combox:eq(1) .tag").removeClass("this"),$(".group_editor .combox:eq(1) .tag").find("input").removeAttr("checked"))})},l=function(){$(".group_editor .tag").live("click",function(){var e=$(this);if(select=!1,e.toggleClass("this"),e.hasClass("this")?(select=!0,e.find("input").attr("checked",!0)):(select=!1,e.find("input").removeAttr("checked")),e.parent().hasClass("combox")){var t=e.index();1==t&&0==select&&(e.parent().find(".tag").removeClass("this"),e.parent().find("input").removeAttr("checked")),1!=t&&1==select&&(e.parent().find(".tag:eq(0)").addClass("this"),e.parent().find("input:eq(0)").attr("checked",!0))}}),$(".system_role li.role_cell").live("click",function(){n($(this).attr("data-role-id"))}),$("#content_system_role [data-action]").live("click",function(e){var a=$(this).attr("data-action");switch($(this),a){case"role_add":n();break;case"role_delete":s(t);break;case"role_edit_save":o();break;case"revert_all":r();break;default:}stopPP(e)})},c=function(t){var a=e[t];return a?a.name:'<span style="color:#f00">null</span>'},d=function(){var t={};return $.each(e,function(e,a){t[e]=a.name}),t};return l(),{init:a,get_list:d,set_select:n}});